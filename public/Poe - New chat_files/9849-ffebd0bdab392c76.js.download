(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9849],{83498:function(e,a,n){"use strict";var t,l=n(67294);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}a.Z=function(e){return l.createElement("svg",s({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),t||(t=l.createElement("path",{d:"M4 13h14.09l-6.79 6.79a.996.996 0 1 0 1.41 1.41l8.5-8.5c.06-.06.09-.13.13-.2.03-.04.06-.08.08-.13a.91.91 0 0 0 .08-.37c0-.03-.01-.05-.01-.07-.01-.1-.02-.21-.06-.31a.955.955 0 0 0-.22-.33L12.72 2.8c-.2-.2-.45-.29-.71-.29-.26 0-.51.1-.71.29a.996.996 0 0 0 0 1.41L18.08 11H4c-.55 0-1 .45-1 1s.45 1 1 1Z"})))}},5466:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},{args:null,kind:"FragmentSpread",name:"ChatMessageInputContainer_useIsBotDisabled_bot"},{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_bot"},{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_bot"}],type:"Bot",abstractKey:null};t.hash="64591fa1b35ef0e11a741e4818e0bbeb",a.default=t},42785:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageInputContainer_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_messageEdges"}],type:"MessageEdge",abstractKey:null};t.hash="3763d1e0a57ccedfde9ee810abab3e3b",a.default=t},61251:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_useIsBotDisabled_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{args:null,kind:"FragmentSpread",name:"botHelpers_useDeletion_bot"}],type:"Bot",abstractKey:null};t.hash="e53845314ed7af231c18539113680869",a.default=t},50467:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_viewer",selections:[{alias:"voiceInputEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_voice_input"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_voice_input")'},{alias:"fileInputEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_file_upload"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_file_upload")'},{alias:"ignoreFileUploadLimit",args:[{kind:"Literal",name:"gateName",value:"ignore_poe_file_upload_limit"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"ignore_poe_file_upload_limit")'},{alias:"useNewLimitSystem",args:[{kind:"Literal",name:"gateName",value:"poe_use_new_limit_system_frontend"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_new_limit_system_frontend")'},{alias:null,args:null,kind:"ScalarField",name:"isLoggedOutUsageEnabled",storageKey:null}],type:"Viewer",abstractKey:null};t.hash="612071bbcb0c761138cf4269f5d32516",a.default=t},46348:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_MessageLimitTooltip_bot",selections:[{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"shouldShowRemainingMessageCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numMessagesRemaining",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageUsageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"baseModelDisplayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null}],type:"Bot",abstractKey:null};t.hash="81aa0eb3ed5b58b038d4e4ada0bc9a57",a.default=t},72612:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_bot",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_MessageLimitTooltip_bot"}],type:"Bot",abstractKey:null};t.hash="eba74d59a2653cb8d880d362c483ed44",a.default=t},9883:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageTextArea_bot",selections:[{args:null,kind:"FragmentSpread",name:"subscriptionHelpers_useBotLogData_bot"}],type:"Bot",abstractKey:null};t.hash="20776269a1a38eb6f9f51ae7691190d6",a.default=t},87330:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"ChatMessageTextArea_getLastHumanMessageText_messageEdge"};t.hash="8f03686b6b6d877ba9b0177dee725b31",a.default=t},73938:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageTextArea_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_useOnKeyDown_messageEdges"}],type:"MessageEdge",abstractKey:null};t.hash="adef175ef9e8eb0b392205c0b7ec1e41",a.default=t},91963:function(e,a,n){"use strict";n.r(a);let t={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageTextArea_useOnKeyDown_messageEdges",selections:[{kind:"InlineDataFragmentSpread",name:"ChatMessageTextArea_getLastHumanMessageText_messageEdge",selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{kind:"InlineDataFragmentSpread",name:"chatHelpers_isHumanMessage",selections:[{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null}],args:null,argumentDefinitions:[]}],storageKey:null}],args:null,argumentDefinitions:[]}],type:"MessageEdge",abstractKey:null};t.hash="326ac8a25d146f97c1aab77fcfc8ef9b",a.default=t},38117:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"getChatContentType_chat"};t.hash="2291a2b3c3c16aec13efd467f4adefba",a.default=t},16761:function(e,a,n){"use strict";var t,l,s,r;n.r(a);let i={fragment:{argumentDefinitions:t=[{defaultValue:null,kind:"LocalArgument",name:"messageId"}],kind:"Fragment",metadata:null,name:"localMessageQuery",selections:[{alias:null,args:l=[{kind:"Variable",name:"messageId",variableName:"messageId"}],concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},{kind:"InlineDataFragmentSpread",name:"messagesConnection_message",selections:[r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"ChatMessagesView_useMessagePairs_messages"},{args:null,kind:"FragmentSpread",name:"ChatHistoryListItem_message"}],args:null,argumentDefinitions:[]}],storageKey:null}],type:"QueryRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:t,kind:"Operation",name:"localMessageQuery",selections:[{alias:null,args:l,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[s,r,{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sourceType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attachmentTruncationState",storageKey:null},{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[r,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null},r],storageKey:null}],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"vote",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"offlineError",storageKey:null}]},{kind:"TypeDiscriminator",abstractKey:"__isNode"}],storageKey:null}]},params:{id:"e4024035e4f8323ec3ced7b253b7ee69c2ca94cc5d09cb61ce00e1c11963ab08",metadata:{},name:"localMessageQuery",operationKind:"query",text:null}};i.hash="ba8e5951a2189610f1c7b6d89d8f886f",a.default=i},51151:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"messagesConnection_message"};t.hash="cfb93ef751c8784742eb56c3f403e5da",a.default=t},17048:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"resendMessage_chat"};t.hash="18d6b5bb8062a445ad9f0eb2fd4f5f1d",a.default=t},71669:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"resendMessage_message"};t.hash="e56e3fa2233e8ab03a48556a6fc0f1ec",a.default=t},53398:function(e,a,n){"use strict";var t,l,s,r,i,o,u,c,d,g,m,p,h,_,f,y,k,b,v,F,C,S,K,T,w,L,x,N,M,E,I,D,B,R,V,A,j,O,Z,U,G;n.r(a);let P=(t={defaultValue:null,kind:"LocalArgument",name:"attachments"},l={defaultValue:null,kind:"LocalArgument",name:"bot"},s={defaultValue:null,kind:"LocalArgument",name:"chatId"},r={defaultValue:null,kind:"LocalArgument",name:"clientNonce"},i={defaultValue:null,kind:"LocalArgument",name:"query"},o={defaultValue:null,kind:"LocalArgument",name:"sdid"},u={defaultValue:null,kind:"LocalArgument",name:"shouldFetchChat"},c={defaultValue:null,kind:"LocalArgument",name:"source"},d=[{kind:"Variable",name:"attachments",variableName:"attachments"},{kind:"Variable",name:"bot",variableName:"bot"},{kind:"Variable",name:"chatId",variableName:"chatId"},{kind:"Variable",name:"clientNonce",variableName:"clientNonce"},{kind:"Variable",name:"query",variableName:"query"},{kind:"Variable",name:"sdid",variableName:"sdid"},{kind:"Variable",name:"source",variableName:"source"}],g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},f={alias:null,args:null,concreteType:"MessageCreateFailedUrl",kind:"LinkedField",name:"failedUrls",plural:!0,selections:[_={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reason",storageKey:null}],storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"chatCode",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"hasMarkdownRendering",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"sourceType",storageKey:null},N={alias:null,args:null,kind:"ScalarField",name:"attachmentTruncationState",storageKey:null},M={alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[g,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null},g],storageKey:null}],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},A={kind:"TypeDiscriminator",abstractKey:"__isNode"},j={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},O={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},Z={alias:null,args:null,kind:"ScalarField",name:"isDeleted",storageKey:null},U=[{kind:"Literal",name:"last",value:5}],G={alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null},{fragment:{argumentDefinitions:[t,l,s,r,i,o,u,c],kind:"Fragment",metadata:null,name:"sendMessageMutation",selections:[{alias:null,args:d,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,{kind:"InlineDataFragmentSpread",name:"messagesConnection_message",selections:[g,{args:null,kind:"FragmentSpread",name:"ChatMessagesView_useMessagePairs_messages"},{args:null,kind:"FragmentSpread",name:"ChatHistoryListItem_message"}],args:null,argumentDefinitions:[]},{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_message",selections:[g],args:null,argumentDefinitions:[]}]}],storageKey:null},{args:null,kind:"FragmentSpread",name:"sendMessageMutation_messageEdge"}],storageKey:null},p,h,f,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[g,y,k,b,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[g,v,F],storageKey:null},{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_chat",selections:[g,y,k,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[v],storageKey:null},{kind:"InlineDataFragmentSpread",name:"getChatContentType_chat",selections:[{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[C],storageKey:null}],args:null,argumentDefinitions:[]}],args:null,argumentDefinitions:[]},{args:[{kind:"Literal",name:"numMessages",value:5}],kind:"FragmentSpread",name:"ChatHistoryListItem_chat"},{args:null,kind:"FragmentSpread",name:"ChatPage_chat"}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ChatPage_viewer"}],storageKey:null}]}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[s,l,i,c,r,o,t,u],kind:"Operation",name:"sendMessageMutation",selections:[{alias:null,args:d,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,g,S,K,T,w,L,x,N,M,E={alias:null,args:null,kind:"ScalarField",name:"vote",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},B={alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null},V={kind:"ClientExtension",selections:[R={alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"offlineError",storageKey:null}]},A],storageKey:null},j],storageKey:null},p,h,f,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[g,y,k,b,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[g,v,F,C,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"deletionState",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"image",plural:!1,selections:[O,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"localName",storageKey:null}],type:"LocalBotImage",abstractKey:null},{kind:"InlineFragment",selections:[_],type:"UrlBotImage",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsCreator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSystemBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsFollower",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"followerCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shareLink",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"canSend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowSubscriptionRationale",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dailyLimit",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"numMessagesRemaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowRemainingMessageCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageUsageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"shouldPromptSubscription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowLimitInfoBanner",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"totalBalance",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canUserAccessBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"baseModelDisplayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasClearContext",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"monthlyActiveUsers",storageKey:null},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"creator",plural:!1,selections:[Z,{alias:null,args:[{kind:"Literal",name:"size",value:"small"}],kind:"ScalarField",name:"profilePhotoUrl",storageKey:'profilePhotoUrl(size:"small")'},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:"nullableHandle",args:null,kind:"ScalarField",name:"handle",storageKey:null},g,A],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"poweredBy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"serverBotDependenciesLimitsString",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageTimeoutSecs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isLimitedAccess",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"baseBotId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasSuggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsResend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasWelcomeTopics",storageKey:null},A],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastInteractionTime",storageKey:null},{alias:null,args:U,concreteType:"MessagesConnection",kind:"LinkedField",name:"messagesConnection",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[K,T,g,O,m,w,B,S,L,x,N,M,E,I,D,V,A],storageKey:null},j,g],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},g],storageKey:"messagesConnection(last:5)"},{alias:null,args:U,filters:null,handle:"connection",key:"ChatMessagesView_chat_messagesConnection",kind:"LinkedHandle",name:"messagesConnection"},Z,{alias:null,args:null,kind:"ScalarField",name:"shouldShowDisclaimer",storageKey:null},A,{kind:"ClientExtension",selections:[R]}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[G,g,S],storageKey:null},{alias:"allowDragDrop",args:[{kind:"Literal",name:"gateName",value:"poe_file_drag_and_drop"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_file_drag_and_drop")'},{alias:"allowImages",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images")'},{alias:"allowImagesForApiBots",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images_for_api_bots"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images_for_api_bots")'},{alias:"enableImageViewer",args:[{kind:"Literal",name:"gateName",value:"poe_web_image_viewer"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_image_viewer")'},{alias:null,args:null,kind:"ScalarField",name:"promptBotImageDomainWhitelist",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasActiveSubscription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebSubscriptions",storageKey:null},{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"expiresTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"willCancelAtPeriodEnd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"purchaseRevocationReason",storageKey:null}],storageKey:null},{alias:"useNewLimitSystem",args:[{kind:"Literal",name:"gateName",value:"poe_use_new_limit_system_frontend"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_new_limit_system_frontend")'},G,{alias:"enableResendButton",args:[{kind:"Literal",name:"gateName",value:"poe_resend_button_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_resend_button_web")'},{alias:"retryButtonEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_message_retry_button"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_message_retry_button")'},{alias:"poeMessageDropdownImageOptions",args:[{kind:"Literal",name:"gateName",value:"poe_message_dropdown_image_options"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_message_dropdown_image_options")'},{alias:"showTruncationWarning",args:[{kind:"Literal",name:"gateName",value:"poe_show_truncation_warning"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_truncation_warning")'},{alias:"decoupleBotHandleAndName",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_handle_display_name_decoupling"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_handle_display_name_decoupling")'},{alias:"improvePrivacyConfidence",args:[{kind:"Literal",name:"gateName",value:"poe_improve_privacy_confidency"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_improve_privacy_confidency")'},{alias:"enableBotMetadata",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_metadata_user_view"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_metadata_user_view")'},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeResponseSpeedUpsell",storageKey:null},{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBot",plural:!1,selections:[F,g],storageKey:null},{alias:"voiceInputEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_voice_input"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_voice_input")'},{alias:"fileInputEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_file_upload"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_file_upload")'},{alias:"ignoreFileUploadLimit",args:[{kind:"Literal",name:"gateName",value:"ignore_poe_file_upload_limit"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"ignore_poe_file_upload_limit")'},{alias:null,args:null,kind:"ScalarField",name:"isLoggedOutUsageEnabled",storageKey:null},{alias:"shouldUseRefactor",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_chat_helpers_refactor"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_chat_helpers_refactor")'},g],storageKey:null}]}],storageKey:null}]},params:{id:"96452f18e0379f7a1c2af2e380fe56a8f758688124cd21430c871eb6858f77e3",metadata:{},name:"sendMessageMutation",operationKind:"mutation",text:null}});P.hash="f091a780f2568df580e4c40aee185002",a.default=P},92750:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_chat"};t.hash="41e13c12a815d056441458d26ccd44e2",a.default=t},87065:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_chat"};t.hash="a89e2ef3aa0f92238aa0d73fce6a7cff",a.default=t},13182:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_message"};t.hash="a3edfe280a68f7340ebe0be36940756a",a.default=t},4690:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_onMessageSendChatUpdate_chat"};t.hash="3f09cda2a6e7d19e423600d1197a875f",a.default=t},97048:function(e,a,n){"use strict";n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_onSuccessUpdater_chat"};t.hash="e187d425ce85c7c5b60fdcf18a7a0a41",a.default=t},50922:function(e,a,n){"use strict";n.d(a,{Z:function(){return eN}});var t,l,s,r,i=n(85893),o=n(11163),u=n(67294),c=n(22120),d=n(22578),g=n(2012),m=n(53143),p=n(26074),h=n(37650);let _=["text/*","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/octet-stream"],f=["text/rtf"];var y=n(8655),k=n(38154),b=n.n(k),v=n(69295);function F(){return(F=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var C=function(e){return u.createElement("svg",F({viewBox:"0 0 15 26",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=u.createElement("path",{d:"M7.11 26C3.287 26 .178 22.757.178 18.772V5.312C.179 2.382 2.469 0 5.285 0 6.66 0 7.947.559 8.913 1.573a5.38 5.38 0 0 1 1.478 3.74v11.439c0 1.872-1.472 3.395-3.282 3.395-1.809 0-3.281-1.523-3.281-3.395V8.333a1 1 0 0 1 2 0v8.418c0 .769.575 1.394 1.281 1.394.707 0 1.282-.625 1.282-1.394V5.31c0-.894-.328-1.732-.926-2.36a2.998 2.998 0 0 0-2.18-.952c-1.713 0-3.106 1.485-3.106 3.312v13.46c0 2.882 2.212 5.228 4.93 5.228 2.72 0 4.932-2.346 4.932-5.228V8.333a1 1 0 0 1 2 0v10.439c0 3.985-3.109 7.228-6.932 7.228Z"})))},S=n(70442),K=n.n(S),T=e=>{let{onFileUpload:a,...n}=e,t=(0,u.useRef)(null),l=(0,u.useCallback)(()=>{var e;null==t||null===(e=t.current)||void 0===e||e.click()},[]),s=(0,u.useCallback)(e=>{if(e.target.files){let n=Array.from(e.target.files);e.target.value="",a(n)}},[a]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.t9,{className:K().button,onClick:l,...n,children:(0,i.jsx)(C,{})}),(0,i.jsx)("input",{className:K().input,ref:t,type:"file",multiple:!0,onChange:s})]})},w=n(39620),L=n(34616),x=n(25432),N=n.n(x),M=e=>{let{children:a,onDismiss:n,className:t}=e,l=(0,u.useCallback)(e=>{e.stopPropagation(),n()},[n]);return(0,i.jsxs)("div",{className:(0,L.$)(N().dismissableContainer,t),children:[a,(0,i.jsx)("button",{className:N().dismissButton,onClick:l,children:(0,i.jsx)(w.Z,{className:N().icon})})]})},E=n(81791),I=n.n(E),D=e=>{let{children:a,className:n}=e,t=(0,u.useRef)(null),l=(0,u.useCallback)(e=>{t.current&&(e.preventDefault(),e.stopPropagation(),t.current.scrollLeft+=e.deltaY,t.current.scrollLeft+=e.deltaX)},[]);return(0,u.useEffect)(()=>{let e=t.current;return e&&e.addEventListener("wheel",l),()=>{e&&e.removeEventListener("wheel",l)}},[l]),(0,i.jsx)("div",{ref:t,className:(0,L.$)(I().container,n),children:a})},B=n(47180),R=n.n(B);let V=e=>{let{file:a,index:n,onDismiss:t}=e,l=(0,u.useCallback)(()=>{t(n)},[t,n]);return(0,i.jsx)(M,{onDismiss:l,className:R().attachmentWrapper,children:(0,i.jsx)(p.Z,{name:a.name,size:a.size,mimeType:a.type})})};var A=e=>{let{files:a,fileIds:n,onFileRemoved:t}=e,l=(0,u.useCallback)(e=>{t(e)},[t]);return a.length?(0,i.jsx)(D,{className:R().container,children:a.map((e,a)=>(0,i.jsx)("div",{className:R().attachment,children:(0,i.jsx)(V,{file:e,index:a,onDismiss:l})},n[a]))}):null};n(44311);var j=n(83498),O=n(92002),Z=n.n(O),U=n(18974);let G=e=>{let{bot:a,useNewLimitSystem:t=!1,isLoggedOutChat:l=!1}=e,{t:s}=(0,c.$G)(),r=(0,d.useFragment)(n(46348),a),{messageLimit:o,messageUsageLimit:u,baseModelDisplayName:g,limitedAccessType:m,isApiBot:p}=r,{shouldShowRemainingMessageCount:h,numMessagesRemaining:_}=o,{balanceTooltipText:f}=u,y=t||l?!!u.balanceTooltipText:h;return y?(0,i.jsx)("div",{className:Z().noFreeMessageTooltip,children:t||l?f:m!==U.Z.no_limit||p?g?s("{{baseModelDisplayName}}: {{numMessagesRemaining}} left",{baseModelDisplayName:g,numMessagesRemaining:_}):s("{{numMessagesRemaining}} left",{numMessagesRemaining:_}):s("Standard bots: {{numMessagesRemaining}} left",{numMessagesRemaining:_})}):null};var P=e=>{let{bot:a,useNewLimitSystem:t=!1,isLoggedOutChat:l=!1,className:s,...r}=e,o=(0,d.useFragment)(n(72612),a);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.DF,{className:(0,L.$)(Z().sendButton,s),...r,children:(0,i.jsx)(j.Z,{})}),(0,i.jsx)(G,{bot:o,useNewLimitSystem:t,isLoggedOutChat:l})]})},H=n(20014),z=n(35409),W=n(71953),q=n.n(W);let $=e=>{let a=(0,u.useRef)([]),n=(0,u.useCallback)(e=>{a.current.forEach(a=>a(e))},[]),t=(0,u.useCallback)(e=>{n(e.target.value)},[n]),l=(0,u.useCallback)(n=>{if(a.current.push(n),1===a.current.length){var l;null===(l=e.current)||void 0===l||l.addEventListener("input",t)}},[e,t]),s=(0,u.useCallback)(n=>{if(a.current=a.current.filter(e=>e!==n),0===a.current.length){var l;null===(l=e.current)||void 0===l||l.removeEventListener("input",t)}},[e,t]);return(0,u.useEffect)(()=>()=>{var a;null===(a=e.current)||void 0===a||a.removeEventListener("input",t)},[e,t]),{addValueChangedListener:l,removeValueChangedListener:s,onValueChange:n}},Q=(0,u.forwardRef)((e,a)=>{let{className:n,onInput:t,onChange:l,footer:s,...r}=e,o=(0,u.useRef)(null),c=(0,u.useRef)(null),d=(0,u.useCallback)(()=>{o.current&&c.current&&(o.current.dataset.replicatedValue=c.current.value)},[]),g=(0,u.useCallback)(e=>{null==t||t(e),d()},[t,d]),{addValueChangedListener:m,removeValueChangedListener:p,onValueChange:h}=$(c);return(0,u.useImperativeHandle)(a,()=>({focus:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.focus()},blur:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.blur()},addEventListener:(e,a,n)=>{var t;return null===(t=c.current)||void 0===t?void 0:t.addEventListener(e,a,n)},removeEventListener:(e,a,n)=>{var t;return null===(t=c.current)||void 0===t?void 0:t.removeEventListener(e,a,n)},getValue:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.value},setValue:e=>{c.current&&(c.current.value=e,c.current.scrollTo(0,c.current.scrollHeight),d(),h(e))},addValueChangedListener:m,removeValueChangedListener:p}),[d,m,p,h]),(0,i.jsxs)("div",{className:(0,L.$)(q().growWrap,n),ref:o,children:[(0,i.jsx)("textarea",{className:q().textArea,ref:c,rows:1,onInput:g,onChange:l,...r}),s]})});Q.displayName="GrowingTextArea";var J=n(71289);(t=s||(s={}))[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SPACE=32]="SPACE",t[t.ESC=27]="ESC",t[t.UP=38]="UP",t[t.DOWN=40]="DOWN",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.HOME=36]="HOME",t[t.END=35]="END";var X=s,Y=n(77614),ee=n(81534),ea=n(78739);let en=e=>{if(!e)return null;for(let a=e.length-1;a>=0;a--){let{node:t}=(0,d.readInlineData)(n(87330),e[a]);if((0,J.Q1)(t))return t.text}return null},et=(e,a,t,l,s,r,i)=>{let o=(0,d.useFragment)(n(91963),e),{shouldPromptSubscription:c,openPaywall:g}=(0,ea.rk)(),m=(0,u.useCallback)(e=>{e.preventDefault(),c?(s(Y.Z.limited_access_bot),g()):i?r():t()},[c,g,s,t,r,i]),p=(0,u.useCallback)(e=>{var n,t;if(!(null===(n=a.current)||void 0===n?void 0:n.getValue())){e.preventDefault();let n=en(o);n&&(null===(t=a.current)||void 0===t||t.setValue(n),l())}},[o,a,l]);return(0,u.useCallback)(e=>{e.shiftKey||e.keyCode!=X.ENTER?e.keyCode==X.UP&&p(e):m(e)},[m,p])},el=(0,u.forwardRef)((e,a)=>{let{edges:t,bot:l,className:s,submitMessage:r,onChange:o,disabled:c,footer:g,placeholderText:m}=e,p=(0,d.useFragment)(n(73938),t),h=(0,d.useFragment)(n(9883),l),_=(0,u.useRef)(null),{logClick:f}=(0,ee.B)(h),{shouldShowSignupWall:k,openSignupWall:b}=(0,z.zl)(),v=(0,u.useCallback)(()=>{var e;null===(e=_.current)||void 0===e||e.setValue(""),b(z.dh.sendMessage)},[b]),{userHasNoMessagesLeft:F}=(0,H.a)(),C=k&&F,S=et(p,_,r,o,f,v,C),{shouldPromptSubscription:K,openPaywall:T}=(0,ea.rk)(),w=(0,u.useCallback)(()=>{var e;null===(e=_.current)||void 0===e||e.setValue(""),f(Y.Z.limited_access_bot),T()},[f,T]),L=(0,u.useMemo)(()=>(0,y.Z)([_,a]),[_,a]),x=K?w:C?v:void 0;return(0,i.jsx)(Q,{ref:L,className:s,placeholder:m,onFocus:x,onInput:x,onChange:o,onKeyDown:S,disabled:c,footer:g})});el.displayName="ChatMessageTextArea";var es=n(41143),er=n.n(es),ei=n(63236);function eo(){return(eo=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var eu=function(e){return u.createElement("svg",eo({viewBox:"0 0 16 27",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=u.createElement("path",{clipRule:"evenodd",d:"M4.235 1.803C4.848.823 6.013 0 8 0c1.986 0 3.152.824 3.765 1.803a3.826 3.826 0 0 1 .568 1.836V3.664s0 .003-1 .003h1v10.666h-1 1v.028a1.823 1.823 0 0 1-.01.176 3.827 3.827 0 0 1-.558 1.66C11.152 17.177 9.986 18 8 18c-1.987 0-3.152-.824-3.765-1.803a3.828 3.828 0 0 1-.568-1.836V14.336s0-.003 1-.003h-1V3.667h1-1v-.028a2.004 2.004 0 0 1 .01-.176 3.827 3.827 0 0 1 .558-1.66Zm1.432 1.874.002-.036a1.828 1.828 0 0 1 .262-.778C6.152 2.51 6.653 2 8 2s1.848.51 2.069.863a1.83 1.83 0 0 1 .264.814v10.646l-.002.036a1.83 1.83 0 0 1-.262.778c-.221.353-.722.863-2.07.863-1.346 0-1.847-.51-2.068-.863a1.828 1.828 0 0 1-.264-.814V3.677Zm-4.334 4.99a1 1 0 0 1 1 1v4.666l.001.03a5.657 5.657 0 0 0 .087.725c.09.49.27 1.13.62 1.76a4.464 4.464 0 0 0 1.62 1.69c.76.457 1.827.795 3.339.795s2.579-.338 3.34-.795a4.464 4.464 0 0 0 1.62-1.69c.349-.63.528-1.27.62-1.76a5.642 5.642 0 0 0 .086-.724V9.667a1 1 0 1 1 2 0v4.666h-1 1v.035a3.958 3.958 0 0 1-.016.302 7.653 7.653 0 0 1-.104.783 7.85 7.85 0 0 1-.839 2.366 6.464 6.464 0 0 1-2.338 2.434c-.902.541-2.013.914-3.37 1.037v3.377h4.334a1 1 0 0 1 0 2H2.667a1 1 0 1 1 0-2H7v-3.378c-1.356-.122-2.467-.495-3.369-1.036a6.463 6.463 0 0 1-2.339-2.434 7.852 7.852 0 0 1-.838-2.366 7.66 7.66 0 0 1-.118-1.015 3.637 3.637 0 0 1-.002-.07v-.032s0-.003 1-.003h-1V9.667a1 1 0 0 1 1-1Z"})))},ec=n(62341),ed=n(19029),eg=n(74929),em=n(47986),ep=n.n(em),eh=n(6488),e_=n(39885);let ef=()=>{let{userAgent:e}=window.navigator;return(0,eg.P)(e)?null:"undefined"!=typeof SpeechRecognition?SpeechRecognition:"undefined"!=typeof webkitSpeechRecognition?webkitSpeechRecognition:null},ey=(e,a)=>{switch(a.error){case"no-speech":return e("No speech was detected. Try again.");case"audio-capture":return e("No microphone was found. Ensure that a microphone is installed and that microphone settings are configured correctly.");case"not-allowed":return e("Permission to use microphone was denied. Update your browser permission settings and try again.");case"network":return e("A network error occurred. Check your internet connection and try again.");case"language-not-supported":return e("The language {{language}} is not supported by your browser.",{language:(null==a?void 0:a.target)&&"lang"in a.target&&a.target.lang||"en"});case"aborted":if("No speech detected"===a.message)return e("No speech was detected. Try again.");return null;default:return e("An error occurred: {{error}}",{error:a.error})}};class ek extends ec.n9{constructor(e){let a=[e.error,e.message].filter(Boolean).join(": ");super(a),this.name="SpeechRecognitionError"}}let eb=e=>{("aborted"!==e.error||"No speech detected"===e.message)&&(0,ec.H)(new ek(e))},ev=e=>{let{onStart:a,onEnd:n,onError:t,onResult:l}=e,s=ef();er()(s,"SpeechRecognition is not supported");let r=new s;return r.continuous=!0,r.interimResults=!0,r.onstart=a,r.onspeechend=()=>{r.stop()},r.onend=n,r.onerror=t,r.onresult=l,r},eF=(e,a,n)=>{let{t}=(0,c.$G)(),[l,s]=(0,u.useState)(!1),r=(0,u.useRef)(!1),i=(0,u.useCallback)(()=>r.current,[]),o=(0,u.useContext)(ei.Z),d=(0,u.useRef)(null),g=(0,u.useCallback)(()=>{var e;null===(e=d.current)||void 0===e||e.stop(),d.current=null},[]),m=(0,u.useCallback)(()=>{var e;null===(e=d.current)||void 0===e||e.abort(),d.current=null},[]),p=(0,u.useCallback)(()=>{var l;let i=(null===(l=e.current)||void 0===l?void 0:l.getValue())||"",u=null==o?void 0:o.botId,c=null==o?void 0:o.model,m=null==o?void 0:o.chatId,p=ev({onStart:()=>{var a,n;null===(a=e.current)||void 0===a||a.blur(),null===(n=e.current)||void 0===n||n.addEventListener("focus",g),s(!0),(0,ed.Z)("poe/action_log",{action_type:(0,e_.E)(eh.Z.start_voice_record),bot_id:u,chat_id:m,model_name:c})},onEnd:()=>{var a,n;s(!1),null===(a=e.current)||void 0===a||a.focus(),null===(n=e.current)||void 0===n||n.removeEventListener("focus",g),(0,ed.Z)("poe/action_log",{action_type:(0,e_.E)(eh.Z.finish_voice_record),bot_id:u,chat_id:m,model_name:c})},onError:e=>{eb(e);let a=ey(t,e);if(a){var l;null===(l=n.current)||void 0===l||l.setTooltip(a)}},onResult:n=>{let{results:t}=n;if(d.current===p){let n=Array.from(t).filter(e=>e[0].confidence>0).map(e=>e[0].transcript).join("");if(n){var l;r.current=!0,null===(l=e.current)||void 0===l||l.setValue(i+n),a()}}}});d.current=p,p.start()},[e,a,s,n,g,t,o]);return(0,u.useEffect)(()=>{let a=e.current,n=e=>{""==e&&(r.current=!1)};return null==a||a.addValueChangedListener(n),()=>{null==a||a.removeValueChangedListener(n)}},[e]),(0,u.useEffect)(()=>()=>{m()},[m]),{isRunning:l,startRecognition:p,stopRecognition:g,abortRecognition:m,getVoiceInputUsed:i}},eC=(0,u.forwardRef)((e,a)=>{let[n,t]=(0,u.useState)(null),[l,s]=(0,u.useState)(0),r=(0,u.useRef)(null);return(0,u.useImperativeHandle)(a,()=>({setTooltip:e=>{t(e),s(e=>e+1),null!==r.current&&clearTimeout(r.current),r.current=window.setTimeout(()=>{t(null)},5e3)}}),[]),n?(0,i.jsx)("div",{className:ep().tooltip,children:n},l):null});eC.displayName="Tooltip";let eS=(0,u.forwardRef)((e,a)=>{let{className:n,chatInputRef:t,onInputChange:l,...s}=e,{shouldShowSignupWall:r,openSignupWall:o}=(0,z.zl)(),{userHasNoMessagesLeft:c}=(0,H.a)(),d=(0,u.useCallback)(()=>{o(z.dh.sendMessage)},[o]),g=(0,u.useRef)(null),{isRunning:m,startRecognition:p,stopRecognition:h,abortRecognition:_,getVoiceInputUsed:f}=eF(t,l,g);return(0,u.useImperativeHandle)(a,()=>({startRecognition:p,stopRecognition:h,abortRecognition:_,getVoiceInputUsed:f}),[p,h,_,f]),(0,i.jsxs)(v.t9,{className:(0,L.$)(ep().button,n),onClick:r&&c?d:m?h:p,"aria-selected":!!m,...s,children:[(0,i.jsx)(eC,{ref:g}),(0,i.jsx)(eu,{})]})});eS.displayName="ChatMessageVoiceInputButtonInner";let eK=(0,u.forwardRef)((e,a)=>{let[n,t]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{t(!!ef())},[]),n?(0,i.jsx)(eS,{ref:a,...e}):null});eK.displayName="ChatMessageVoiceInputButton";let eT=e=>{let a=(0,d.useFragment)(n(61251),e),{isDeleted:t}=(0,h.iZ)(a);return t||a.isDown},ew=(e,a,n)=>{let t=(0,p.t)(e);return a<=1?n("The file you tried to attach is too large. Please try uploading a file that is less than {{fileSizeLimit}}.",{fileSizeLimit:t}):a>1?n("The files you tried to attach are too large. Please try uploading files that are less than {{fileSizeLimit}} total.",{fileSizeLimit:t}):void 0},eL=(e,a)=>e<=1?a("The file you tried to attach has an unsupported file type."):e>1?a("The files you tried to attach have unsupported file types."):void 0,ex=(0,u.forwardRef)((e,a)=>{let{bot:t,viewer:l,edges:s,onSubmitMessage:r,placeholderText:p,isBotResponding:h}=e,k=(0,d.useFragment)(n(5466),t),v=(0,d.useFragment)(n(42785),s),F=(0,d.useFragment)(n(50467),l),C=(0,u.useRef)(0),S=(0,u.useRef)(0),K=(0,u.useRef)(0),w=(0,u.useRef)(new WeakMap),[L,x]=(0,u.useState)([]),N=(0,u.useRef)(null),{t:M}=(0,c.$G)(),E=(0,o.useRouter)(),{isLoggedInUser:I}=(0,g.b)(),D=k.uploadFileSizeLimit,B=(0,u.useCallback)(e=>{let a=e.filter(e=>(function(e){if(""===e)return!0;let[a,n]=e.split("/");return _.some(e=>{let[t,l]=e.split("/");return t===a&&("*"===l||l===n)})&&!f.includes(e)})(e.type)),n=a.filter(e=>e.size<D||F.ignoreFileUploadLimit);n.forEach(e=>{w.current.set(e,C.current++),K.current++,function(e){if(!FileReader||0!==e.size)return;let a=new FileReader;a.onload=()=>{},a.readAsBinaryString(e)}(e)}),x(e=>[...e,...n]);let t=n.reduce((e,a)=>e+a.size,0);S.current+=t;let l=[],s=a.length<e.length,r=S.current>D||n.length<a.length;s&&l.push(eL(e.length-a.length,M)),r&&l.push(ew(D,K.current,M));let i=l.join("\n\n");if(i&&!F.ignoreFileUploadLimit){var o;null===(o=N.current)||void 0===o||o.setTooltip(i)}},[D,M,F.ignoreFileUploadLimit]),{droppedFiles:R,clearDroppedFiles:V}=(0,u.useContext)(m.Z);(0,u.useEffect)(()=>{R.length>0&&(B(R),V())},[R,B,V]);let j=(0,u.useCallback)(e=>{var a;x(a=>a.filter((a,n)=>n!==e));let n=L[e].size;S.current-=n,K.current--;let t="";S.current>D&&!F.ignoreFileUploadLimit&&(t=ew(D,K.current,M)||""),null===(a=N.current)||void 0===a||a.setTooltip(t)},[L,D,M,F.ignoreFileUploadLimit]),O=(0,u.useCallback)(()=>{x([]),S.current=0,K.current=0},[]),Z=L.map(e=>w.current.get(e)||0),U=(0,u.useRef)(null),G=(0,u.useRef)(null),H=(0,u.useMemo)(()=>(0,y.Z)([U,a]),[U,a]),[z,W]=(0,u.useState)(!0),q=(0,u.useCallback)(()=>{var e,a;W((null===(a=U.current)||void 0===a?void 0:null===(e=a.getValue())||void 0===e?void 0:e.trim())==="")},[]),$=eT(k),Q=$||h||z||S.current>D&&!F.ignoreFileUploadLimit,J=(0,u.useCallback)(()=>{var e,a;if(null===(e=G.current)||void 0===e||e.abortRecognition(),navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&(null===(a=U.current)||void 0===a||a.blur()),!Q)return r(U,G,L,O)},[U,G,L,O,Q,r]),X=(0,u.useCallback)(()=>{var e;null===(e=U.current)||void 0===e||e.focus()},[U]),Y=(0,u.useRef)(!1);return(0,u.useEffect)(()=>{var e;(I||!0!==Y.current)&&(null===(e=U.current)||void 0===e||e.focus(),Y.current=!0)},[k.id,E,I]),(0,i.jsxs)("div",{className:b().inputContainer,onClickCapture:X,children:[(0,i.jsx)(el,{ref:H,edges:v,bot:k,className:b().textArea,submitMessage:J,onChange:q,disabled:$,placeholderText:p,footer:(0,i.jsx)(A,{files:L,fileIds:Z,onFileRemoved:j})}),F.fileInputEnabled&&D>0&&(0,i.jsxs)("div",{className:b().fileInput,children:[(0,i.jsx)(T,{disabled:$||S.current>D&&!F.ignoreFileUploadLimit,onFileUpload:B}),(0,i.jsx)(eC,{ref:N})]}),F.voiceInputEnabled&&(0,i.jsx)(eK,{ref:G,className:b().voiceInputButton,chatInputRef:U,onInputChange:q,disabled:$}),(0,i.jsx)(P,{className:b().sendButton,bot:k,useNewLimitSystem:F.useNewLimitSystem,isLoggedOutChat:F.isLoggedOutUsageEnabled,onClick:J,disabled:Q})]})});ex.displayName="ChatMessageInputContainer";var eN=ex},42050:function(e,a,n){"use strict";var t=n(85893),l=n(67294),s=n(34616),r=n(11781),i=n.n(r),o=n(30791);a.Z=e=>{let{header:a,startAtBottom:n,children:r}=e,u=(0,l.useRef)(null);return(0,t.jsxs)(t.Fragment,{children:[a,(0,t.jsx)(o.f.Provider,{value:u,children:(0,t.jsx)("div",{ref:u,className:(0,s.$)(i().scrollSection,n&&i().startAtBottom),children:(0,t.jsx)("div",{className:i().column,children:r})})})]})}},44254:function(e,a,n){"use strict";var t=n(85893),l=n(34616),s=n(32600),r=n.n(s),i=n(21209);a.Z=e=>(0,t.jsxs)(i.Z,{className:(0,l.$)(e.useChatTitle?r().chatTitleNavbar:r().navbar,e.className),children:[(0,t.jsx)("div",{className:r().leftNavItem,children:e.leftNavItem}),(0,t.jsx)("div",{className:e.useChatTitle?r().chatTitleItem:r().titleItem,children:"title"in e?(0,t.jsx)("h1",{className:r().headerTitle,children:e.title}):e.children}),(0,t.jsx)("div",{className:r().rightNavItem,children:e.rightNavItem})]})},72306:function(e,a,n){"use strict";n.d(a,{Z:function(){return _}});var t,l=n(85893),s=n(67294),r=n(16990),i=n(34616),o=n(46217),u=n.n(o),c=n(69295);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var g=function(e){return s.createElement("svg",d({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),t||(t=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 6a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1ZM2 12a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1ZM2 18a1 1 0 0 1 1-1h18a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1Z"})))},m=n(61340),p=n.n(m),h=e=>{let{className:a,...n}=e;return(0,l.jsx)(c.t9,{className:(0,i.$)(p().button,a),...n,children:(0,l.jsx)(g,{className:p().hamburgerIcon})})},_=e=>{let{className:a}=e,{setLeftSidebar:n}=(0,r.Qp)(),t=(0,s.useCallback)(()=>{n(()=>r.PI.OPEN)},[n]);return(0,l.jsx)(h,{onClick:t,className:(0,i.$)(u().button,a),"aria-label":"toggle sidebar"})}},53143:function(e,a,n){"use strict";n.d(a,{Z:function(){return c}});var t=n(85893),l=n(67294),s=n(22120),r=n(34616),i=n(76069),o=n.n(i);let u=e=>{var a;let n=(null===(a=e.dataTransfer)||void 0===a?void 0:a.types)||[];return n.some(e=>"Files"!==e)},c=(0,l.createContext)({droppedFiles:[],clearDroppedFiles:()=>{}});a.C=e=>{let{className:a,enabled:n,children:i}=e,[d,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(!n)return;let e=0,a=e=>{e.preventDefault()},t=a=>{a.preventDefault(),u(a)||(e++,g(!0))},l=a=>{a.preventDefault(),0==--e&&g(!1)},s=()=>{e=0,g(!1)};return document.addEventListener("dragover",a),document.addEventListener("dragenter",t),document.addEventListener("dragleave",l),document.addEventListener("drop",s),()=>{document.removeEventListener("dragover",a),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",l),document.removeEventListener("drop",s)}},[n]);let[m,p]=(0,l.useState)(!1),h=(0,l.useCallback)(e=>{e.preventDefault(),u(e)||p(!0)},[]),_=(0,l.useCallback)(e=>{e.preventDefault(),p(!1)},[]),[f,y]=(0,l.useState)([]),k=(0,l.useCallback)(e=>{e.preventDefault();let a=Array.from(e.dataTransfer.files);y(a),g(!1),p(!1)},[]),b=(0,l.useCallback)(()=>{y([])},[]),v=(0,l.useMemo)(()=>({droppedFiles:f,clearDroppedFiles:b}),[f,b]),F=(0,r.$)(a,o().dropTarget,d&&o().showDropTarget,m&&o().hoveredDropTarget),{t:C}=(0,s.$G)();return n?(0,t.jsxs)(c.Provider,{value:v,children:[(0,t.jsx)("div",{className:F,onDrop:k,onDragEnter:h,onDragLeave:_,children:(0,t.jsx)("span",{className:o().dropTargetText,children:C("Drop files here")})}),i]}):(0,t.jsx)(t.Fragment,{children:i})}},26074:function(e,a,n){"use strict";n.d(a,{Z:function(){return m},t:function(){return d}});var t,l=n(85893),s=n(67294);function r(){return(r=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var i=function(e){return s.createElement("svg",r({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),t||(t=s.createElement("path",{d:"M7.692 21.714h9.222c1.798 0 2.692-.916 2.692-2.732v-7.925c0-1.126-.13-1.615-.825-2.331l-4.784-4.897c-.66-.68-1.208-.829-2.18-.829H7.692C5.903 3 5 3.925 5 5.74v13.242c0 1.825.894 2.732 2.692 2.732Zm.06-1.405c-.894 0-1.354-.48-1.354-1.353V5.767c0-.864.46-1.362 1.363-1.362h3.865v5.072c0 1.1.547 1.64 1.632 1.64h4.95v7.84c0 .872-.46 1.352-1.363 1.352H7.753Zm5.663-10.51c-.348 0-.478-.139-.478-.488V4.676L17.94 9.8h-4.524Z"})))},o=n(34616),u=n(73870),c=n.n(u);let d=function(e){if(0==e)return"0 bytes";let a=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,a)).toFixed(0))+" "+["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]},g=new Map([["text/plain","TEXT"],["text/csv","CSV"],["text/html","HTML"],["application/pdf","PDF"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","DOCX"]]);var m=e=>{let{name:a,size:n,mimeType:t,token:s,attachmentID:r,loading:u=!1,titleWraps:m=!1}=e,p=g.get(t)||"FILE",h="".concat(p," \xb7 ").concat(d(n)),_=(0,o.$)(c().fileInfo,u&&c().loading),f=(0,o.$)(c().title,!m&&c().noTitleWrap),y=s&&r?"a":"div",k=s&&r?{href:"/api/download?token=".concat(s,"&id=").concat(r),target:"_blank"}:{};return(0,l.jsxs)(y,{className:_,...k,children:[(0,l.jsx)(i,{className:c().icon}),(0,l.jsxs)("div",{className:c().textPane,children:[(0,l.jsx)("div",{className:f,children:a}),(0,l.jsxs)("div",{className:c().metadata,children:[h," "]})]})]})}},81032:function(e,a,n){"use strict";n.d(a,{C:function(){return s},U:function(){return l}});var t=n(80393);let l="ChatMessagesView_chat_messagesConnection",s=()=>(0,t.z)(16)},60030:function(e,a,n){"use strict";var t=n(44311),l=n(89083);a.Z=e=>{let{defaultBotObject:a}=(0,t.readInlineData)(n(38117),e);return a.hasMarkdownRendering?l.Z.text_markdown:l.Z.text_plain}},27488:function(e,a,n){"use strict";n.d(a,{f:function(){return o},m:function(){return i}});var t=n(41143),l=n.n(t);n(44311),n(16761);let s=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"File");return l()("File"===n.getType(),"Expected ".concat(a.id," to be a File, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.mimeType,"mimeType"),n.setValue(a.size,"size"),n.setValue(a.token,"token"),n},r=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"Attachment");return l()("Attachment"===n.getType(),"Expected ".concat(a.id," to be an Attachment, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.name,"name"),n.setLinkedRecord(s(e,a.file),"file"),n},i=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"Message");return l()("Message"===n.getType(),"Expected ".concat(a.id," to be a Message, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.messageId,"messageId"),n.setValue(a.attachmentTruncationState,"attachmentTruncationState"),n.setValue(a.author,"author"),n.setValue(a.clientNonce,"clientNonce"),n.setValue(a.contentType,"contentType"),n.setValue(a.creationTime,"creationTime"),n.setValue(a.isOptimistic,"isOptimistic"),n.setValue(a.messageId,"messageId"),n.setValue(a.offlineError,"offlineError"),n.setValue(a.sourceType,"sourceType"),n.setValue(a.state,"state"),n.setValue(a.suggestedReplies.slice(),"suggestedReplies"),n.setValue(a.text,"text"),n.setValue(a.textLengthOnCancellation,"textLengthOnCancellation"),n.setValue(a.timeoutLevel,"timeoutLevel"),n.setValue(a.vote,"vote"),n.setLinkedRecords(a.attachments.map(a=>r(e,a)),"attachments"),n},o=(e,a)=>{l()("Message"===e.getType(),"Cannot set status of record of type ".concat(e.getType())),e.setValue(a,"state")}},44912:function(e,a,n){"use strict";n.d(a,{Ci:function(){return p},Ey:function(){return c},OJ:function(){return d},T5:function(){return m},WL:function(){return f},kz:function(){return _},n3:function(){return g}});var t=n(41143),l=n.n(t),s=n(44311),r=n(81032);let i=e=>{l()("Chat"===e.getType(),"Cannot add messages to a record of type ".concat(e.getType()));let a=s.ConnectionHandler.getConnection(e,r.U);return l()(a,"Cannot find connection ".concat(r.U)),a},o=n(51151),u=(e,a)=>{let n=i(e),t=n.getLinkedRecords("edges");if(!t)return!1;let l=t.map(e=>{var a;return null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getDataID()});return l.includes(a)},c=e=>{let a=i(e),n=a.getLinkedRecords("edges");l()(n,"No edges found in chat connection");let t=n.sort((e,a)=>{var n,t;let s=null===(n=e.getLinkedRecord("node"))||void 0===n?void 0:n.getValue("creationTime"),r=null===(t=a.getLinkedRecord("node"))||void 0===t?void 0:t.getValue("creationTime");return l()(s,"Node A time is ".concat(s)),l()(r,"Node B time is ".concat(r)),s<r?-1:1}),s=t[n.length-1];return null==s?void 0:s.getLinkedRecord("node")},d=(e,a,n)=>{let t=(0,s.readInlineData)(o,n),r=e.get(t.id);return l()(r,"Cannot find message record with id ".concat(t.id)),g(e,a,r)},g=(e,a,n)=>{l()("Chat"===a.getType(),"Cannot add messages to a record of type ".concat(a.getType())),l()("Message"===n.getType(),"Cannot add record of type ".concat(n.getType()," to Chat"));let t=i(a),r=s.ConnectionHandler.createEdge(e,t,n,"MessageEdge");return s.ConnectionHandler.insertEdgeAfter(t,r),r},m=(e,a)=>{let n=i(e);s.ConnectionHandler.deleteNode(n,a)},p=(e,a,n,t)=>{let r=(0,s.readInlineData)(o,t),u=e.get(r.id);l()("Chat"===a.getType(),"Cannot remove message edges from a record of type ".concat(a.getType())),l()(u,"Unable to find message of id ".concat(r.id));let c=i(a),d=c.getLinkedRecords("edges");l()(d,"No edges found in chat connection");let g=d.findIndex(e=>{var a;return(null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getValue("id"))===n});return -1!==g&&(d[g]=s.ConnectionHandler.createEdge(e,c,u,"MessageEdge"),c.setLinkedRecords(d,"edges"),!0)},h=(e,a,n,t)=>{let r=(0,s.readInlineData)(o,t),u=e.get(r.id);l()("Chat"===a.getType(),"Cannot remove message edges from a record of type ".concat(a.getType())),l()(u,"Unable to find message of id ".concat(r.id)),l()("MessageEdge"===n.getType(),"Cannot remove record of type ".concat(n.getType()," from Chat"));let c=i(a),d=c.getLinkedRecords("edges");l()(d,"No edges found in chat connection");let g=s.ConnectionHandler.createEdge(e,c,u,"MessageEdge"),m=!1,p=d.map(e=>e.getDataID()===n.getDataID()?(m=!0,g):e);return c.setLinkedRecords(p,"edges"),m},_=(e,a,n,t)=>{l()("Chat"===a.getType(),"Cannot remove message edges from a record of type ".concat(a.getType())),l()(!n||"MessageEdge"===n.getType(),"Cannot remove record of type ".concat(n?n.getType():n," from Chat"));let r=(0,s.readInlineData)(o,t),c=e.get(r.id),d=u(a,r.id);if(d)return c;let g=!0;if(n&&(g=!h(e,a,n,t)),g){l()(c,"Unable to find message of id ".concat(r.id));let n=i(a),t=s.ConnectionHandler.createEdge(e,n,c,"MessageEdge");s.ConnectionHandler.insertEdgeAfter(n,t)}return c},f=e=>{let a=i(e),n=a.getLinkedRecords("edges");n&&n.forEach(e=>{let n=e.getLinkedRecord("node");(null==n?void 0:n.getValue("isOptimistic"))&&s.ConnectionHandler.deleteNode(a,n.getDataID())})}},64076:function(e,a,n){"use strict";n.d(a,{Gx:function(){return d},dS:function(){return g},sC:function(){return m}});var t=n(68220),l=n(85649),s=n(89083),r=n(31268),i=n(8611),o=n(27488);let u=()=>Math.floor(1e9*Math.random()),c=(e,a)=>{let n,t;do n=u(),t="Optimistic-".concat(a,"-").concat(n);while(e.get(t));return[t,n]},d=(e,a)=>{let{prompt:n,files:s=[],source:r,clientNonce:u,contentType:d}=a,[g,m]=c(e,"HumanMessage"),p=s.map(a=>{let[n]=c(e,"MessageAttachment"),[t]=c(e,"File");return{id:n,name:a.name,file:{id:t,token:"",url:"",size:a.size,mimeType:a.type}}});return(0,o.m)(e,{id:g,messageId:m,attachmentTruncationState:t.Z.not_truncated,attachments:p,author:l.Z.human,clientNonce:u,contentType:d,creationTime:1e3*Date.now(),isOptimistic:!0,offlineError:null,sourceType:r.sourceType,state:i.Z.complete,suggestedReplies:[],text:n,textLengthOnCancellation:null,timeoutLevel:0,vote:null})},g=(e,a)=>{let{author:n,contentType:l,text:s="",state:u=i.Z.incomplete}=a,[d,g]=c(e,"BotMessage");return(0,o.m)(e,{id:d,messageId:g,attachmentTruncationState:t.Z.not_truncated,attachments:[],author:n,clientNonce:null,contentType:l,creationTime:1e3*Date.now(),isOptimistic:!0,offlineError:null,sourceType:r.Z.chat_input,state:u,suggestedReplies:[],text:s,textLengthOnCancellation:null,timeoutLevel:0,vote:null})},m=(e,a)=>{let{clientNonce:n}=a,[u,d]=c(e,"ChatBreakMessage");return(0,o.m)(e,{id:u,messageId:d,attachmentTruncationState:t.Z.not_truncated,attachments:[],author:l.Z.chat_break,clientNonce:n,contentType:s.Z.text_plain,creationTime:1e3*Date.now(),isOptimistic:!0,offlineError:null,sourceType:r.Z.chat_input,state:i.Z.complete,suggestedReplies:[],text:"",textLengthOnCancellation:null,timeoutLevel:0,vote:null})}},21774:function(e,a,n){"use strict";n.d(a,{Mo:function(){return h},Us:function(){return f},gc:function(){return p}});var t=n(41143),l=n.n(t),s=n(67294),r=n(22578),i=n(44311),o=n(18093),u=n(2197),c=n(44912),d=n(21851);let g=new Map,m=e=>{let a=g.get(e);if(!a)throw Error("No args for nonce ".concat(e));return a},p=(e,a)=>g.set(e,a),h=e=>g.delete(e),_=e=>{let{environment:a,message:t,chat:s,setToast:r,onSuccessfulMessageSend:o}=e,{id:u,isOptimistic:g,clientNonce:p}=(0,i.readInlineData)(n(71669),t),h=(0,i.readInlineData)(n(17048),s);l()(g&&p,"Message must be optimistic to resend");let{optimisticUpdate:_,...f}=m(p);(0,i.commitLocalUpdate)(a,e=>{let a=e.get(h.id);l()(a,"Expected chat record ".concat(h.id," to exist")),(0,c.T5)(a,u)}),a.revertUpdate(_),(0,d.b)({environment:a,chat:h,setToast:r,onSuccessfulMessageSend:o,...f})},f=e=>{let{message:a,chat:n}=e,t=(0,r.useRelayEnvironment)(),l=(0,u.ZP)(),{resetLoggedOutTimeout:i}=(0,o.v)();return(0,s.useCallback)(function(){let{onSuccessfulMessageSend:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_({environment:t,message:a,chat:n,setToast:l,onSuccessfulMessageSend:a=>{null==e||e(a),i()}})},[t,l,a,n,i])}},21851:function(e,a,n){"use strict";n.d(a,{b:function(){return M},$:function(){return A}});var t=n(41143),l=n.n(t),s=n(67294),r=n(22578),i=n(18093),o=n(2197),u=n(37650),c=n(36025),d=n(71289),g=n(46857),m=n(75408),p=n(50530),h=n(47875),_=n(8611),f=n(81032),y=n(60030),k=n(44311);let b=e=>{let a=e.getLinkedRecords("edges");if(a)return a;e.setLinkedRecords([],"edges");let n=e.getLinkedRecords("edges");return l()(n,"Cannot find edges on connection record ".concat(e.getDataID())),n},v=(e,a,n,t)=>{let l=b(a),s=l.find(e=>{var a;return(null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getDataID())===n.getDataID()})||k.ConnectionHandler.createEdge(e,a,n,t);k.ConnectionHandler.deleteNode(a,n.getDataID()),k.ConnectionHandler.insertEdgeBefore(a,s)},F=(e,a)=>{let n=e.get(a);l()(n,"Cannot find chat record with id ".concat(a));let t=S(e);v(e,t,n,"ChatEdge")},C=(e,a)=>{let n=S(e);k.ConnectionHandler.deleteNode(n,a)},S=e=>{let a=e.getRoot(),n=k.ConnectionHandler.getConnection(a,"ChatHistoryList_queryRoot_chats");return l()(n,"Cannot find connection ChatHistoryList_queryRoot_chats"),n};var K=n(27488),T=n(44912),w=n(64076),L=n(21774);let x=e=>{if(!e)return[null,null];let a=Array.from(e).reduce((e,a,n)=>({...e,["file".concat(n)]:a}),{});return[a,Array.from(Object.keys(a))]},N=n(53398),M=async e=>{let{environment:a,chat:t,prompt:s,source:i,files:o=[],setToast:d,onSuccessfulMessageSend:m=()=>{},clientNonce:_,shouldUpdateChatHistory:y=!0}=e,k=(0,g.h0)(),{id:b,chatId:v,isOptimistic:S,defaultBotObject:K,...T}=(0,r.readInlineData)(n(92750),t),w=_||(0,f.C)(),M={storeUpdater:e=>{y&&F(e,b),(0,u.rY)(e,K.id)}};(0,L.gc)(w,{prompt:s,files:o,source:i,optimisticUpdate:M});let{optimisticHumanMessageId:D,optimisticHumanMessageEdgeId:A}=E({environment:a,chat:T,prompt:s,files:o,source:i,clientNonce:w}),[j,O]=x(o),Z=await k;a.applyUpdate(M),(0,r.commitMutation)(a,{mutation:N,variables:{chatId:S?null:v,shouldFetchChat:!!S,bot:K.nickname,query:s,source:i,clientNonce:w,attachments:O,sdid:Z},uploadables:j,updater:(e,a)=>{var n,t;if((null===(n=a.messageEdgeCreate)||void 0===n?void 0:n.status)===h.Z.success&&(null===(t=a.messageEdgeCreate)||void 0===t?void 0:t.message)){B(e,{chat:T,optimisticHumanMessageEdgeId:A,messageData:a.messageEdgeCreate.message.node});let n=a.messageEdgeCreate.chat;S&&n&&R(e,{chat:n,message:a.messageEdgeCreate.message.node,optimisticChatId:b}),y&&(a.messageEdgeCreate.chat?(C(e,b),F(e,a.messageEdgeCreate.chat.id)):F(e,b)),(0,u.rY)(e,K.id)}else V(e,{chatNodeId:b,optimisticHumanMessageEdgeId:A})},onCompleted:e=>{a.revertUpdate(M);let n=I(e,d,D,w);n&&m(e)},onError:()=>{(0,r.commitLocalUpdate)(a,e=>{V(e,{chatNodeId:b,optimisticHumanMessageEdgeId:A})})}}),l()((0,p.hj)(D),"Expected optimistic human message id to be a number"),(0,c.CE)(D,v)},E=e=>{let a,t,{environment:s,chat:i,prompt:o,files:u,source:c,clientNonce:d}=e,{id:g,...m}=(0,r.readInlineData)(n(4690),i),h=(0,y.Z)(m);return(0,r.commitLocalUpdate)(s,e=>{let n=e.get(g);l()(n,"Expected Chat record with id ".concat(g," to exist when sending a message"));let s=(0,w.Gx)(e,{prompt:o,files:u,source:c,clientNonce:d,contentType:h}),r=(0,T.n3)(e,n,s);a=r.getDataID(),t=s.getValue("messageId")}),l()((0,p.hj)(t),"Expected optimistic human message id to be a number"),l()(a,"Expected optimistic human message edge id to exist"),{optimisticHumanMessageId:t,optimisticHumanMessageEdgeId:a}},I=(e,a,n,t)=>{let s=e.messageEdgeCreate.status;if(s!==h.Z.success)return a({type:o.pC.error,content:e.messageEdgeCreate.statusMessage}),!1;let r=D(e.messageEdgeCreate.failedUrls);return r&&a({type:o.pC.error,content:r}),l()(e.messageEdgeCreate.message,"No message on a successful send message mutation"),(0,c.Ot)(n,e.messageEdgeCreate.message.node.messageId),(0,L.Mo)(t),!0},D=e=>{if(0===e.length)return null;let a=e[0].reason;if(1===e.length)switch(a){case"fetch_error":return"Failed to fetch ".concat(e[0].url," because of a problem crawling the URL.");case"over_budget":return"Failed to fetch ".concat(e[0].url," because it was too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e[0].url," because it was not a supported content type.");default:return"Failed to fetch ".concat(e[0].url,".")}switch(a){case"fetch_error":return"Failed to fetch ".concat(e.length," urls because of problems crawling them.");case"over_budget":return"Failed to fetch ".concat(e.length," urls because they were too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e.length," urls because of unsupported content types.");default:return"Failed to fetch ".concat(e.length," urls.")}},B=(e,a)=>{let{chat:t,optimisticHumanMessageEdgeId:s,messageData:i}=a,{id:o,defaultBotObject:u,...c}=(0,r.readInlineData)(n(97048),t),d=e.get(o),g=e.get(s);l()(d,"Expected Chat record with id ".concat(o," to exist when sending a message"));let m=(0,T.kz)(e,d,g,i),p=(0,T.Ey)(d);if((null==p?void 0:p.getDataID())===(null==m?void 0:m.getDataID())){let a=(0,y.Z)(c),n=(0,w.dS)(e,{contentType:a,author:u.nickname});(0,T.n3)(e,d,n)}},R=(e,a)=>{let{chat:t,message:s,optimisticChatId:i}=a,o=(0,r.readInlineData)(n(87065),t),{id:u}=(0,r.readInlineData)(n(13182),s);(0,m.mK)(o.chatId,i);let c=e.get(o.id);l()(c,"Cannot find chat record with id ".concat(o.id)),e.getRoot().setLinkedRecord(c,"chatOfCode",{chatCode:o.chatCode});let d=(0,T.Ey)(c);if((null==d?void 0:d.getDataID())===u){let a=(0,y.Z)(o),n=(0,w.dS)(e,{contentType:a,author:o.defaultBotObject.nickname});(0,T.n3)(e,c,n)}},V=(e,a)=>{var n;let{chatNodeId:t,optimisticHumanMessageEdgeId:s}=a,r=e.get(t),i=null===(n=e.get(s))||void 0===n?void 0:n.getLinkedRecord("node");l()(r,"Expected Chat record with id ".concat(t," to exist when sending a message")),l()(i,"Expected optimistic human message to exist after sending a message"),(0,K.f)(i,_.Z.error)},A=e=>{let{source:a,chat:n}=e,t=(0,r.useRelayEnvironment)(),l=(0,o.ZP)(),{resetLoggedOutTimeout:u}=(0,i.v)(),c=(0,s.useContext)(d.cq),g=(0,s.useCallback)(async e=>{let{prompt:s,files:r,source:i,onSuccessfulMessageSend:o,clientNonce:d}=e;return await M({environment:t,chat:n,prompt:s,files:r,source:i||a,setToast:l,onSuccessfulMessageSend:e=>{null==o||o(e),u()},clientNonce:d,shouldUpdateChatHistory:!c.isEmbed})},[n,t,l,a,u,c]);return g}},8655:function(e,a,n){"use strict";n(67294),a.Z=function(e){return a=>{e.forEach(e=>{"function"==typeof e?e(a):null!=e&&(e.current=a)})}}},68220:function(e,a){"use strict";var n,t;(t=n||(n={})).not_truncated="not_truncated",t.truncated="truncated",t.parse_failure="parse_failure",a.Z=n},85649:function(e,a){"use strict";var n,t;(t=n||(n={})).human="human",t.dummy="dummy",t.chat_break="chat_break",t.rat="rat",t.echo_bot="echo_bot",t.a1="a1",t.a1_honest="a1_honest",t.a1_professor="a1_professor",t.a1_t0="a1_t0",t.a1_honest2="a1_honest2",t.a1_honest3="a1_honest3",t.a2="a2",t.a2_test="a2_test",t.a2_2="a2_2",t.a2_100k="a2_100k",t.a2_2_100k="a2_2_100k",t.mnm="mnm",t.mnm_safety="mnm_safety",t.mnm_t0="mnm_t0",t.davinci2="davinci2",t.davinci3="davinci3",t.capybara="capybara",t.nutria="nutria",t.chinchilla="chinchilla",t.beaver="beaver",t.capybara_test="capybara_test",t.nutria_test="nutria_test",t.capybara_search="capybara_search",t.agouti="agouti",t.vizcacha="vizcacha",t.chinchilla_instruct="chinchilla_instruct",t.gpt3_5="gpt3_5",t.hutia="hutia",t.pacarana="pacarana",t.bot_query_api="bot_query_api",t.acouchy="acouchy",t.acouchy_code="acouchy_code",t.acouchy_search_grounded="acouchy_search_grounded",t.llama_2_70b_chat="llama_2_70b_chat",t.llama_2_13b_chat="llama_2_13b_chat",t.llama_2_7b_chat="llama_2_7b_chat",t.code_llama_7b_instruct="code_llama_7b_instruct",t.code_llama_13b_instruct="code_llama_13b_instruct",t.code_llama_34b_instruct="code_llama_34b_instruct",t.upstage_solar_0_70b_16bit="upstage_solar_0_70b_16bit",t.qwen_7b_chat="qwen_7b_chat",t.mistral_7b_instruct="mistral_7b_instruct",a.Z=n},31268:function(e,a){"use strict";var n,t;(t=n||(n={})).welcome_topic="welcome_topic",t.linked_phrase="linked_phrase",t.suggested_reply="suggested_reply",t.chat_input="chat_input",t.continue_conversation="continue_conversation",t.quora_machine_answer_interaction="quora_machine_answer_interaction",t.quora_ask_new_question_interaction="quora_ask_new_question_interaction",a.Z=n},70442:function(e){e.exports={button:"ChatMessageFileInputButton_button___6Emy",input:"ChatMessageFileInputButton_input__svNx4"}},47180:function(e){e.exports={"compact-only":"only screen and (max-width : 684px)",container:"ChatMessageInputAttachments_container__AAxGu",attachment:"ChatMessageInputAttachments_attachment__ZTrHT",attachmentWrapper:"ChatMessageInputAttachments_attachmentWrapper__mTQm_"}},38154:function(e){e.exports={"compact-only":"only screen and (max-width : 684px)",inputContainer:"ChatMessageInputContainer_inputContainer__s2AGa",textArea:"ChatMessageInputContainer_textArea__fNi6E",sendButton:"ChatMessageInputContainer_sendButton__dBjTt",fileInput:"ChatMessageInputContainer_fileInput__9lLAY"}},92002:function(e){e.exports={sendButton:"ChatMessageSendButton_sendButton__4ZyI4",noFreeMessageTooltip:"ChatMessageSendButton_noFreeMessageTooltip__9IhzY"}},47986:function(e){e.exports={button:"ChatMessageVoiceInputButton_button__NjXno",pulse:"ChatMessageVoiceInputButton_pulse__5F2SB",tooltip:"ChatMessageVoiceInputButton_tooltip__oz4tA",fadeInUpAndOut:"ChatMessageVoiceInputButton_fadeInUpAndOut__NP3s1"}},11781:function(e){e.exports={scrollSection:"MainColumn_scrollSection__A9NHB",column:"MainColumn_column__UEunw",startAtBottom:"MainColumn_startAtBottom__KeM8B"}},32600:function(e){e.exports={navbar:"BaseNavbar_navbar__IqOxl",chatTitleNavbar:"BaseNavbar_chatTitleNavbar__JROLE",leftNavItem:"BaseNavbar_leftNavItem__dm85A",rightNavItem:"BaseNavbar_rightNavItem__3DfWJ",titleItem:"BaseNavbar_titleItem__IQ3_j",chatTitleItem:"BaseNavbar_chatTitleItem__GtrXf",headerTitle:"BaseNavbar_headerTitle__DF3y3"}},46217:function(e){e.exports={button:"ToggleSidebarButton_button__2yFLU"}},25432:function(e){e.exports={dismissableContainer:"Dismissable_dismissableContainer__4Q5Jv",dismissButton:"Dismissable_dismissButton__faL3Y",icon:"Dismissable_icon__nU8Xb"}},76069:function(e){e.exports={dropTarget:"DragDrop_dropTarget__MOI6m",showDropTarget:"DragDrop_showDropTarget__m4ebm",hoveredDropTarget:"DragDrop_hoveredDropTarget__E5qJJ",dropTargetText:"DragDrop_dropTargetText__K1oOh"}},73870:function(e){e.exports={fileInfo:"FileInfo_fileInfo__5ZvMO",loading:"FileInfo_loading__XwVJt",icon:"FileInfo_icon__HhOin",textPane:"FileInfo_textPane__d9VVB",title:"FileInfo_title__sUM2l",noTitleWrap:"FileInfo_noTitleWrap__xCH7p",metadata:"FileInfo_metadata__Wu4uZ"}},71953:function(e){e.exports={growWrap:"GrowingTextArea_growWrap__im5W3",textArea:"GrowingTextArea_textArea__ZWQbP"}},81791:function(e){e.exports={container:"HorizontallyScrollable_container__biWGT"}},61340:function(e){e.exports={button:"ToggleButton_button__Kwe2x",hamburgerIcon:"ToggleButton_hamburgerIcon__bxJlW"}}}]);