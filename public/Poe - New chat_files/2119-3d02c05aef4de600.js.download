"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2119],{18773:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LoginStatusContextWrapper_viewer",selections:[{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};n.hash="e90b07f525a729d379d67d8d23638ddb",a.default=n},42838:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"botHelpers_useDeletion_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"deletionState",storageKey:null}],type:"Bot",abstractKey:null};n.hash="9055843994f978f06f4287ddd47770eb",a.default=n},82071:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"botHelpers_useIsSDXL_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"baseBotId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null}],type:"Bot",abstractKey:null};n.hash="18a7b2a14544f2ec7958beb7b31af2e1",a.default=n},34905:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"botHelpers_useViewerCanAccessPrivateBot",selections:[{alias:null,args:null,kind:"ScalarField",name:"canUserAccessBot",storageKey:null}],type:"Bot",abstractKey:null};n.hash="a546c361bedaf1bbab944d85f0092d95",a.default=n},98965:function(e,a,l){var n,t,s,i,r,o,u,d,c,g,m,k,p,y,f,h,_,F,b,K,S,L,C;l.r(a);let v=(m={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"chatCode",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"isDeleted",storageKey:null},b={kind:"TypeDiscriminator",abstractKey:"__isNode"},K=[{kind:"Literal",name:"last",value:5}],S={alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null},{fragment:{argumentDefinitions:[n={defaultValue:null,kind:"LocalArgument",name:"attachments"},t={defaultValue:null,kind:"LocalArgument",name:"bot"},s={defaultValue:null,kind:"LocalArgument",name:"query"},i={defaultValue:null,kind:"LocalArgument",name:"sdid"},r={defaultValue:null,kind:"LocalArgument",name:"source"}],kind:"Fragment",metadata:null,name:"chatHelpersSendNewChatMessageMutation",selections:[{alias:null,args:o=[{kind:"Variable",name:"attachments",variableName:"attachments"},{kind:"Variable",name:"bot",variableName:"bot"},{kind:"Variable",name:"query",variableName:"query"},{kind:"Variable",name:"sdid",variableName:"sdid"},{kind:"Variable",name:"source",variableName:"source"}],concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[u={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},g={alias:null,args:null,concreteType:"MessageCreateFailedUrl",kind:"LinkedField",name:"failedUrls",plural:!0,selections:[c={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reason",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[m,k,p,y,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[m,f,h],storageKey:null},{args:[{kind:"Literal",name:"numMessages",value:5}],kind:"FragmentSpread",name:"ChatHistoryListItem_chat"},{args:null,kind:"FragmentSpread",name:"ChatPage_chat"}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ChatPage_viewer"}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,s,r,i,n],kind:"Operation",name:"chatHelpersSendNewChatMessageMutation",selections:[{alias:null,args:o,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[u,d,g,{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[m,k,p,y,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[m,f,h,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"deletionState",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"image",plural:!1,selections:[_,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"localName",storageKey:null}],type:"LocalBotImage",abstractKey:null},{kind:"InlineFragment",selections:[c],type:"UrlBotImage",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsCreator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSystemBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerIsFollower",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"followerCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shareLink",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"canSend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowSubscriptionRationale",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dailyLimit",storageKey:null},m,{alias:null,args:null,kind:"ScalarField",name:"numMessagesRemaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowRemainingMessageCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageLimit",kind:"LinkedField",name:"messageUsageLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"shouldPromptSubscription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowLimitInfoBanner",storageKey:null},m,{alias:null,args:null,kind:"ScalarField",name:"totalBalance",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canUserAccessBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"baseModelDisplayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasClearContext",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"monthlyActiveUsers",storageKey:null},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"creator",plural:!1,selections:[F,{alias:null,args:[{kind:"Literal",name:"size",value:"small"}],kind:"ScalarField",name:"profilePhotoUrl",storageKey:'profilePhotoUrl(size:"small")'},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:"nullableHandle",args:null,kind:"ScalarField",name:"handle",storageKey:null},m,b],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"poweredBy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"serverBotDependenciesLimitsString",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageTimeoutSecs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isLimitedAccess",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"baseBotId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasSuggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsResend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasWelcomeTopics",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasMarkdownRendering",storageKey:null},b],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastInteractionTime",storageKey:null},{alias:null,args:K,concreteType:"MessagesConnection",kind:"LinkedField",name:"messagesConnection",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},m,_,{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null},S,{alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sourceType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attachmentTruncationState",storageKey:null},{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[m,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"token",storageKey:null},m],storageKey:null}],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"vote",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},{kind:"ClientExtension",selections:[L,{alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"offlineError",storageKey:null}]},b],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},m],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},m],storageKey:"messagesConnection(last:5)"},{alias:null,args:K,filters:null,handle:"connection",key:"ChatMessagesView_chat_messagesConnection",kind:"LinkedHandle",name:"messagesConnection"},F,{alias:null,args:null,kind:"ScalarField",name:"shouldShowDisclaimer",storageKey:null},b,{kind:"ClientExtension",selections:[L]}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[C,m,S],storageKey:null},{alias:"allowDragDrop",args:[{kind:"Literal",name:"gateName",value:"poe_file_drag_and_drop"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_file_drag_and_drop")'},{alias:"allowImages",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images")'},{alias:"allowImagesForApiBots",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images_for_api_bots"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images_for_api_bots")'},{alias:"enableImageViewer",args:[{kind:"Literal",name:"gateName",value:"poe_web_image_viewer"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_image_viewer")'},{alias:null,args:null,kind:"ScalarField",name:"promptBotImageDomainWhitelist",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasActiveSubscription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebSubscriptions",storageKey:null},{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null},m,{alias:null,args:null,kind:"ScalarField",name:"expiresTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"willCancelAtPeriodEnd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"purchaseRevocationReason",storageKey:null}],storageKey:null},{alias:"useNewLimitSystem",args:[{kind:"Literal",name:"gateName",value:"poe_use_new_limit_system_frontend"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_new_limit_system_frontend")'},C,{alias:"enableResendButton",args:[{kind:"Literal",name:"gateName",value:"poe_resend_button_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_resend_button_web")'},{alias:"retryButtonEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_message_retry_button"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_message_retry_button")'},{alias:"poeMessageDropdownImageOptions",args:[{kind:"Literal",name:"gateName",value:"poe_message_dropdown_image_options"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_message_dropdown_image_options")'},{alias:"showTruncationWarning",args:[{kind:"Literal",name:"gateName",value:"poe_show_truncation_warning"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_truncation_warning")'},{alias:"decoupleBotHandleAndName",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_handle_display_name_decoupling"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_handle_display_name_decoupling")'},{alias:"improvePrivacyConfidence",args:[{kind:"Literal",name:"gateName",value:"poe_improve_privacy_confidency"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_improve_privacy_confidency")'},{alias:"enableBotMetadata",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_metadata_user_view"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_metadata_user_view")'},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeResponseSpeedUpsell",storageKey:null},{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBot",plural:!1,selections:[h,m],storageKey:null},{alias:"voiceInputEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_voice_input"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_voice_input")'},{alias:"fileInputEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_file_upload"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_file_upload")'},{alias:"ignoreFileUploadLimit",args:[{kind:"Literal",name:"gateName",value:"ignore_poe_file_upload_limit"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"ignore_poe_file_upload_limit")'},{alias:null,args:null,kind:"ScalarField",name:"isLoggedOutUsageEnabled",storageKey:null},{alias:"shouldUseRefactor",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_chat_helpers_refactor"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_chat_helpers_refactor")'},m],storageKey:null}],storageKey:null}]},params:{id:"c115c574e08dcba4c5e879c3ef2b961f6669a0f1b6403cfcd6d9c517191bcba0",metadata:{},name:"chatHelpersSendNewChatMessageMutation",operationKind:"mutation",text:null}});v.hash="22165792cf3c9cc5de10247bcb3dd7b5",a.default=v},53979:function(e,a,l){var n,t,s,i,r,o,u,d,c;l.r(a);let g=(n={defaultValue:null,kind:"LocalArgument",name:"chatId"},t={defaultValue:null,kind:"LocalArgument",name:"connections"},s=[{kind:"Variable",name:"chatId",variableName:"chatId"}],u=[i={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},o={alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null}],storageKey:null}],c=[{kind:"Variable",name:"connections",variableName:"connections"}],{fragment:{argumentDefinitions:[n,t],kind:"Fragment",metadata:null,name:"chatHelpers_addMessageBreakEdgeMutation_Mutation",selections:[{alias:null,args:s,concreteType:"MessageBreakEdgeCreate",kind:"LinkedField",name:"messageBreakEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:u,storageKey:null},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"introductionMessage",plural:!1,selections:u,storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,n],kind:"Operation",name:"chatHelpers_addMessageBreakEdgeMutation_Mutation",selections:[{alias:null,args:s,concreteType:"MessageBreakEdgeCreate",kind:"LinkedField",name:"messageBreakEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:d=[i,o,r],storageKey:null},{alias:null,args:null,filters:null,handle:"appendEdge",key:"",kind:"LinkedHandle",name:"message",handleArgs:c},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"introductionMessage",plural:!1,selections:d,storageKey:null},{alias:null,args:null,filters:null,handle:"appendEdge",key:"",kind:"LinkedHandle",name:"introductionMessage",handleArgs:c}],storageKey:null}]},params:{id:"9450e06185f46531eca3e650c26fa8524f876924d1a8e9a3fb322305044bdac3",metadata:{},name:"chatHelpers_addMessageBreakEdgeMutation_Mutation",operationKind:"mutation",text:null}});g.hash="27417cb8b58d08f9df0071896e4509d9",a.default=g},45981:function(e,a,l){l.r(a);let n={kind:"InlineDataFragment",name:"chatHelpers_isBotMessage"};n.hash="64b43a660c617c778ba7c985fb940384",a.default=n},33740:function(e,a,l){l.r(a);let n={kind:"InlineDataFragment",name:"chatHelpers_isChatBreak"};n.hash="1a0d732e0f7f02a776909413142e4052",a.default=n},71349:function(e,a,l){l.r(a);let n={kind:"InlineDataFragment",name:"chatHelpers_isHumanMessage"};n.hash="8e00e818ac5576af67c698210e1bce47",a.default=n},30561:function(e,a,l){var n,t;l.r(a);let s={fragment:{argumentDefinitions:n=[{defaultValue:null,kind:"LocalArgument",name:"messageId"},{defaultValue:null,kind:"LocalArgument",name:"textLength"}],kind:"Fragment",metadata:null,name:"chatHelpers_messageCancel_Mutation",selections:t=[{alias:null,args:[{kind:"Variable",name:"messageId",variableName:"messageId"},{kind:"Variable",name:"textLength",variableName:"textLength"}],concreteType:"MessageCancel",kind:"LinkedField",name:"messageCancel",plural:!1,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"chatHelpers_messageCancel_Mutation",selections:t},params:{id:"33ae28dd801cbaeb3e988a9db5097b065329af60b99f6de710ffd1fae5ce995e",metadata:{},name:"chatHelpers_messageCancel_Mutation",operationKind:"mutation",text:null}};s.hash="2f821e79b0cce4e82461610e409cebf9",a.default=s},11701:function(e,a,l){var n,t,s,i,r,o,u,d,c,g,m,k,p,y,f,h,_,F,b,K,S,L,C,v,M,w,E;l.r(a);let V=(K={alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},E={alias:null,args:null,concreteType:"MessageCreateFailedUrl",kind:"LinkedField",name:"failedUrls",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reason",storageKey:null}],storageKey:null},{fragment:{argumentDefinitions:[n={defaultValue:null,kind:"LocalArgument",name:"attachments"},t={defaultValue:null,kind:"LocalArgument",name:"bot"},s={defaultValue:null,kind:"LocalArgument",name:"chatId"},i={defaultValue:null,kind:"LocalArgument",name:"clientNonce"},r={defaultValue:null,kind:"LocalArgument",name:"query"},o={defaultValue:null,kind:"LocalArgument",name:"sdid"},u={defaultValue:null,kind:"LocalArgument",name:"source"},d={defaultValue:null,kind:"LocalArgument",name:"withChatBreak"}],kind:"Fragment",metadata:null,name:"chatHelpers_sendMessageMutation_Mutation",selections:[{alias:null,args:c=[{kind:"Variable",name:"attachments",variableName:"attachments"},{kind:"Variable",name:"bot",variableName:"bot"},{kind:"Variable",name:"chatId",variableName:"chatId"},{kind:"Variable",name:"clientNonce",variableName:"clientNonce"},{kind:"Variable",name:"query",variableName:"query"},{kind:"Variable",name:"sdid",variableName:"sdid"},{kind:"Variable",name:"source",variableName:"source"},{kind:"Variable",name:"withChatBreak",variableName:"withChatBreak"}],concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"chatBreak",plural:!1,selections:[g={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},b={alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},F={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null}]}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,k,p,y,f,h,_,K,S,{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[L,{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[C,v],storageKey:null}],storageKey:null},F],storageKey:null}],storageKey:null},M,w,E],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[s,t,r,u,d,i,o,n],kind:"Operation",name:"chatHelpers_sendMessageMutation_Mutation",selections:[{alias:null,args:c,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"chatBreak",plural:!1,selections:[g,b,m],storageKey:null},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[g,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[m,k,p,y,f,h,_,K,S,{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[L,{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[C,v,m],storageKey:null},m],storageKey:null},F],storageKey:null},m],storageKey:null},M,w,E],storageKey:null}]},params:{id:"423f47cbc3c55eaeaa17b78c005e72cefc3dcf2bf1b107c4809828155046ab15",metadata:{},name:"chatHelpers_sendMessageMutation_Mutation",operationKind:"mutation",text:null}});V.hash="0e30a030c506a5964418240dee6f0454",a.default=V},74564:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useSendChatBreak_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null}],type:"Bot",abstractKey:null};n.hash="df2123328cea068438f7fe66448b9329",a.default=n},90281:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useSendChatBreak_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowDisclaimer",storageKey:null}],type:"Chat",abstractKey:null};n.hash="58bbe09aed0f5e9a23ab916e7d20d61f",a.default=n},79390:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useSendMessage_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null}],type:"Bot",abstractKey:null};n.hash="e918c7e4af1f5307b273a4269f03c1df",a.default=n},36462:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useSendMessage_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null}],type:"Chat",abstractKey:null};n.hash="5536b14fce675b91bf26f17487d99fca",a.default=n},14927:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useSendNewChatMessage_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null}],type:"Bot",abstractKey:null};n.hash="fe893156b4a6d16559c80822de9c41bf",a.default=n},93107:function(e,a,l){var n,t,s,i,r,o,u,d,c,g,m;l.r(a);let k=(n=[{defaultValue:null,kind:"LocalArgument",name:"connections"},{defaultValue:null,kind:"LocalArgument",name:"messageId"},{defaultValue:null,kind:"LocalArgument",name:"textLength"}],t=[{kind:"Variable",name:"messageId",variableName:"messageId"},{kind:"Variable",name:"textLength",variableName:"textLength"}],o={alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null}],storageKey:null},c=[u={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},d={alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},i],storageKey:null}],m=[{kind:"Variable",name:"connections",variableName:"connections"}],{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"chatHelpers_useStopMessageAndSendChatBreak_Mutation",selections:[{alias:null,args:t,concreteType:"MessageCancelAndBreakEdgeCreate",kind:"LinkedField",name:"messageCancelAndBreakEdgeCreate",plural:!1,selections:[o,{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"messageBreakEdge",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"introductionMessageEdge",plural:!1,selections:c,storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"chatHelpers_useStopMessageAndSendChatBreak_Mutation",selections:[{alias:null,args:t,concreteType:"MessageCancelAndBreakEdgeCreate",kind:"LinkedField",name:"messageCancelAndBreakEdgeCreate",plural:!1,selections:[o,{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"messageBreakEdge",plural:!1,selections:g=[u,d,s],storageKey:null},{alias:null,args:null,filters:null,handle:"appendEdge",key:"",kind:"LinkedHandle",name:"messageBreakEdge",handleArgs:m},{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"introductionMessageEdge",plural:!1,selections:g,storageKey:null},{alias:null,args:null,filters:null,handle:"appendEdge",key:"",kind:"LinkedHandle",name:"introductionMessageEdge",handleArgs:m}],storageKey:null}]},params:{id:"98865ec11170352a5dc89f056868e26d870ae1aeb586f5c785b3b435f5e6a05e",metadata:{},name:"chatHelpers_useStopMessageAndSendChatBreak_Mutation",operationKind:"mutation",text:null}});k.hash="b9723f63aaf09e124b36110a3a1b1af3",a.default=k},37584:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useStopMessageAndSendChatBreak_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null}],type:"Bot",abstractKey:null};n.hash="61b8765367e446c04af0a76f8d0c4026",a.default=n},38730:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useStopMessageAndSendChatBreak_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null}],type:"Chat",abstractKey:null};n.hash="1c3cd02fad32bc3d8bbf37f07f5190b2",a.default=n},65964:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"chatHelpers_useStopMessageAndSendChatBreak_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"chatHelpers_useStopMessageUpdater_messageEdges"}],type:"MessageEdge",abstractKey:null};n.hash="4a250899291facf858ada9cabddeccd0",a.default=n},87410:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"chatHelpers_useStopMessageUpdater_messageEdges",selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{args:null,kind:"FragmentSpread",name:"useIsMessageCancelled_message"}],storageKey:null}],type:"MessageEdge",abstractKey:null};n.hash="c6fdb046e0f346262cf552d0c245a7fe",a.default=n},90138:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"chatHelpers_useStopMessage_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"chatHelpers_useStopMessageUpdater_messageEdges"}],type:"MessageEdge",abstractKey:null};n.hash="39d15e5667ccfa8c09c3cec226604cda",a.default=n},41360:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null}]}],type:"Message",abstractKey:null};n.hash="81bf0e2e8cac1eedb8a2fbe0ea6a7c89",a.default=n},445:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"messageTimeoutSecs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null}],type:"Bot",abstractKey:null};n.hash="aeb9937d8561a9d558ab137f99466f01",a.default=n},8875:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null}],type:"Chat",abstractKey:null};n.hash="beddec5fd7d466a73b2f09683ce01fd1",a.default=n},38324:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_pairedMessage",selections:[{alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null}],type:"Message",abstractKey:null};n.hash="0cbc94329d5ba05bfa355cdc07ecd5fb",a.default=n},85477:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"chatHelpers_useTimeoutLevel_viewer",selections:[{alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null}],type:"Viewer",abstractKey:null};n.hash="cc43a92f8fa193d702af8ef1d27252be",a.default=n},15421:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"optimisticChat_useCreateOptimisticChat_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null}],type:"Bot",abstractKey:null};n.hash="4cb48ebe801cb479e1334ef3134091b6",a.default=n},16122:function(e,a,l){l.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"optimisticChat_useOptimisticChat_bot",selections:[{args:null,kind:"FragmentSpread",name:"optimisticChat_useCreateOptimisticChat_bot"}],type:"Bot",abstractKey:null};n.hash="90699b91cac95b49724818a1cd06739d",a.default=n},48842:function(e,a,l){function n(e){let{src:a}=e;return a}l.r(a),l.d(a,{default:function(){return n}})},18093:function(e,a,l){l.d(a,{v:function(){return u}});var n=l(85893),t=l(67294),s=l(2012),i=l(35409),r=l(41019);let o=()=>l.e(5239).then(l.bind(l,65239)),u=()=>{let{resetLoggedOutTimeout:e}=t.useContext(d);return{resetLoggedOutTimeout:e}},d=t.createContext({resetLoggedOutTimeout:()=>{}});a.Z=e=>{let{children:a}=e,{isLoggedInUser:l}=(0,s.b)(),[u,c]=(0,t.useState)(!1),[g,m]=(0,t.useState)([]),[k,p]=(0,t.useState)(0),{closeSignupWall:y}=(0,i.zl)();(0,t.useEffect)(()=>{if(!l&&!g.length){let e=window.setTimeout(()=>{c(!0),y(!1)},864e5);g.push(e),m(g)}},[k]);let f=(0,t.useCallback)(()=>{g.length&&g.forEach(e=>window.clearTimeout(e)),m([]),p(k+1)},[g,m,p,k]),h=(0,t.useMemo)(()=>({}),[]),_=(0,t.useMemo)(()=>()=>{},[]),F=(0,t.useMemo)(()=>({resetLoggedOutTimeout:f}),[f]);return(0,n.jsxs)(d.Provider,{value:F,children:[u&&(0,n.jsx)(r.Z,{isOpen:u,onRequestClose:_,body:o,bodyProps:h,showCloseButton:!1}),a]})}},2012:function(e,a,l){l.d(a,{b:function(){return i}});var n=l(85893),t=l(67294),s=l(22578);let i=()=>{let{isLoggedInUser:e}=t.useContext(r);return{isLoggedInUser:e}},r=t.createContext({isLoggedInUser:!1});a.Z=e=>{let{viewer:a,children:i}=e,o=(0,s.useFragment)(l(18773),a),u=!!o.poeUser,d=(0,t.useMemo)(()=>({isLoggedInUser:u}),[u]);return(0,n.jsx)(r.Provider,{value:d,children:i})}},37650:function(e,a,l){l.d(a,{As:function(){return i},FL:function(){return m},Fo:function(){return u},Rq:function(){return g},iZ:function(){return c},nn:function(){return d},rY:function(){return r},vu:function(){return o}});var n=l(22578),t=l(44311),s=l(32914);let i=(e,a)=>{let l=e.getRoot().getLinkedRecord("viewer");if(!l)return;let n=l.getLinkedRecords("availableBots");if(!n)return;let t=n.findIndex(e=>e.getDataID()===a);if(-1===t||t<6)return;let s=[...n.slice(0,5),n[t],...n.slice(5,t),...n.slice(t+1)];l.setLinkedRecords(s,"availableBots")},r=(e,a)=>{var l;let n;let s=e.getRoot().getLinkedRecord("viewer");if(!s)return;let i=t.ConnectionHandler.getConnection(s,"HomeBotSelector_viewer_availableBotsConnection");if(!i)return;let r=i.getLinkedRecords("edges");if(!r||r.length<=6)return;let o=r.findIndex(e=>{var l;return(null===(l=e.getLinkedRecord("node"))||void 0===l?void 0:l.getValue("id"))===a});if(-1!==o&&o<=5)return;if(-1===o){let l=e.get(a);if(!l)return;n=t.ConnectionHandler.createEdge(e,i,l,"BotEdge")}else n=r[o],t.ConnectionHandler.deleteNode(i,a);let u=null===(l=r[5])||void 0===l?void 0:l.getValue("cursor");t.ConnectionHandler.insertEdgeAfter(i,n,u)},o=(e,a)=>{let l=e.getRoot().getLinkedRecord("viewer");if(!l)return;let n=l.getLinkedRecords("availableBots");if(!n)return;let t=n.findIndex(e=>e.getDataID()===a);if(-1===t||t<5)return;let s=[...n.slice(0,t),...n.slice(t+1),n[t]];l.setLinkedRecords(s,"availableBots")},u=(e,a)=>{let l=e.get(a);if(!l)return;let n=e.getRoot().getLinkedRecord("viewer");if(!n)return;let t=n.getLinkedRecords("availableBots");if(!t)return;let s=t.findIndex(e=>e.getDataID()===a);if(-1!==s)return i(e,a);let r=[...t.slice(0,5),l,...t.slice(5)];n.setLinkedRecords(r,"availableBots")},d=e=>{let a=(0,n.useFragment)(l(34905),e);return a.canUserAccessBot},c=e=>{let{deletionState:a}=(0,n.useFragment)(l(42838),e);return{isDeleted:a!==s.Z.not_deleted,isForceDeleted:a!==s.Z.not_deleted&&a!==s.Z.user_deleted,isHardDeleted:a===s.Z.hard_deleted,deletionState:a}},g=1579852,m=e=>{let a=(0,n.useFragment)(l(82071),e);if(!a)return!1;let{baseBotId:t,botId:s}=a;return t===g||s===g}},71289:function(e,a,l){l.d(a,{$3:function(){return N},OE:function(){return v},Q1:function(){return M},Tt:function(){return t},Ue:function(){return S},WC:function(){return D},ZD:function(){return H},cq:function(){return L},gR:function(){return Z},hb:function(){return w},i4:function(){return E},wz:function(){return G},yP:function(){return O}});var n,t,s=l(41143),i=l.n(s),r=l(67294),o=l(22578),u=l(18093),d=l(2197),c=l(36025),g=l(19029),m=l(10406),k=l(75408),p=l(90578),y=l(89083),f=l(47875),h=l(8611),_=l(37650),F=l(55554),b=l(80393),K=l(46857);let S="ChatMessagesView_chat_messagesConnection",L=(0,r.createContext)({isEmbed:!1}),C=()=>Math.floor(1e9*Math.random());(n=t||(t={})).human="human",n.chatBreak="chat_break",n.pacarana="pacarana";let v=e=>{if(!e)return!1;let a=(0,o.readInlineData)(l(45981),e);return!M(a)&&!w(a)},M=e=>{if(!e)return!1;let a=(0,o.readInlineData)(l(71349),e);return a.author===t.human},w=e=>{if(!e)return!1;let a=(0,o.readInlineData)(l(33740),e);return a.author===t.chatBreak},E=(e,a,n,s,u)=>{var d;let c=(0,o.useFragment)(l(41360),e),k=(0,o.useFragment)(l(8875),a),y=(0,o.useFragment)(l(445),n),f=(0,o.useFragment)(l(85477),s),_=(0,o.useFragment)(l(38324),u),F=(0,o.useRelayEnvironment)();return(0,r.useEffect)(()=>{var e;if(c.isOptimistic&&c.author===t.human&&(null!==(e=c.timeoutLevel)&&void 0!==e?e:0)<3){let e=window.setTimeout(()=>{(0,o.commitLocalUpdate)(F,e=>{var a;let l=e.get(c.id);i()(l,"node is ".concat(l));let n=null!==(a=l.getValue("timeoutLevel"))&&void 0!==a?a:0,t=n+1;l.setValue(t,"timeoutLevel"),3===t&&l.setValue(h.Z.error,"state")})},5e3);return()=>{window.clearTimeout(e)}}},[c,F]),(0,r.useEffect)(()=>{var e;let a=Math.floor(y.messageTimeoutSecs/5);if(c.state===h.Z.incomplete&&(!c.isOptimistic||c.author!==t.human)&&(null!==(e=c.timeoutLevel)&&void 0!==e?e:0)<a){let e=window.setTimeout(()=>{(0,o.commitLocalUpdate)(F,e=>{var l,n,t,s,r,o;let u=e.get(c.id);i()(u,"node is ".concat(u));let d=null!==(o=u.getValue("timeoutLevel"))&&void 0!==o?o:0,F=d+1;u.setValue(F,"timeoutLevel"),(0,p.ZR)();let b={message_id:c.messageId,platform:"web",chat_id:k.chatId,default_bot_nickname:y.nickname,user_agent:window.navigator.userAgent,paired_message_id:null==_?void 0:_.messageId,uid:f.uid,isCurrentlyOnline:window.navigator.onLine,hasBeenOffline:(0,m.q)(),timeSinceOrigin:window.performance.now(),connection:{downlink:null===(l=window.navigator.connection)||void 0===l?void 0:l.downlink,effectiveType:null===(n=window.navigator.connection)||void 0===n?void 0:n.effectiveType,rtt:null===(t=window.navigator.connection)||void 0===t?void 0:t.rtt,saveData:null===(s=window.navigator.connection)||void 0===s?void 0:s.saveData,type:null===(r=window.navigator.connection)||void 0===r?void 0:r.type}};F===a?(u.setValue(h.Z.error,"state"),(0,g.Z)("poe/statsd_event",{key:"poe.message.timeout",value:1,category:"count",extra_data:b})):(0,g.Z)("poe/statsd_event",{key:"poe.message.timeout_level.".concat(F),value:1,category:"count",extra_data:b})})},5e3);return()=>{window.clearTimeout(e)}}},[c,F,k,y,_,f]),null!==(d=c.timeoutLevel)&&void 0!==d?d:0},V="ChatMessageInputView_OptimisticHumanMessage",I="ChatMessageInputView_OptimisticChatBreakEdge",T="ChatMessageInputView_OptimisticChatBreak",R="ChatMessageInputView_OptimisticIntroductionMessageEdge",B="ChatMessageInputView_OptimisticIntroductionMessage",N=function(e,a,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],g=(0,o.useFragment)(l(36462),e),m=(0,o.useFragment)(l(79390),a),[k]=(0,o.useMutation)(l(11701)),F=(0,o.useRelayEnvironment)(),{resetLoggedOutTimeout:L}=(0,u.v)(),v=(0,r.useCallback)(e=>{let a=e.get(g.id);i()(a,"chatRecord is ".concat(a));let l=o.ConnectionHandler.getConnection(a,S);i()(l,"connectionRecord is ".concat(l));let n=e.getRootField("messageEdgeCreate");i()(n,"payload is ".concat(n)),Z(e,g.id),(0,_.rY)(e,m.id);let t=n.getLinkedRecord("chatBreak"),s=n.getLinkedRecord("message"),r=null==s?void 0:s.getLinkedRecord("node"),u=null==r?void 0:r.getValue("clientNonce");if(t){let a=o.ConnectionHandler.buildConnectionEdge(e,l,t);i()(a,"newChatBreakEdge is ".concat(a)),o.ConnectionHandler.insertEdgeAfter(l,a)}if(u){let e=l.getLinkedRecords("edges");if(e&&e.some(e=>{var a;return(null===(a=e.getLinkedRecord("node"))||void 0===a?void 0:a.getValue("clientNonce"))===u}))return}let d=o.ConnectionHandler.buildConnectionEdge(e,l,s);d&&(i()(d,"newMessageEdge is ".concat(d)),o.ConnectionHandler.insertEdgeAfter(l,d))},[g,m]),M=(0,d.ZP)(),w=(0,r.useCallback)(async e=>{let{prompt:a,files:l,source:r}=e;(0,p.Si)();let u=(0,b.z)(16),_=await (0,K.h0)(),w=l?Array.from(l).reduce((e,a,l)=>({...e,["file".concat(l)]:a}),{}):void 0,E=l?l.map((e,a)=>({id:"".concat("ChatMessageInputView_OptimisticHumanMessageAttachment","_").concat(a),name:e.name,file:{id:"".concat("ChatMessageInputView_OptimisticHumanMessageAttachmentFile","_").concat(a),size:e.size,mimeType:e.type}})):[];k({variables:{chatId:g.chatId,bot:m.nickname,query:a,source:r||n,withChatBreak:s,clientNonce:u,sdid:_,attachments:w?Array.from(Object.keys(w)):void 0},optimisticResponse:{messageEdgeCreate:{chatBreak:s?{id:I,cursor:T,node:{id:T,messageId:T,text:"",author:t.chatBreak,isOptimistic:!0,suggestedReplies:[],creationTime:1e3*Date.now()-1,state:h.Z.complete,clientNonce:null}}:null,message:{id:"ChatMessageInputView_OptimisticHumanMessageEdge",cursor:V,node:{id:V,messageId:V,text:a,author:t.human,isOptimistic:!0,suggestedReplies:[],creationTime:1e3*Date.now(),state:h.Z.complete,clientNonce:u,contentType:a.length>1e5?y.Z.text_plain:y.Z.text_markdown,attachments:E}},status:f.Z.success,failedUrls:[]}},updater:v,optimisticUpdater:v,onCompleted:e=>{var a;let l=e.messageEdgeCreate.status;if(l!==f.Z.success){M({type:d.pC.error,content:e.messageEdgeCreate.statusMessage});return}let n=U(e.messageEdgeCreate.failedUrls);n&&M({type:d.pC.error,content:n}),L();let t=null===(a=e.messageEdgeCreate.message)||void 0===a?void 0:a.node.messageId;i()(t,"messageId is ".concat(t)),(0,c.Ot)(V,t);let s=()=>setTimeout(()=>{(0,o.commitLocalUpdate)(F,e=>{let a=e.get(g.id);i()(a,"Chat Record is ".concat(a));let l=o.ConnectionHandler.getConnection(a,S);i()(l,"Chat Connection is ".concat(l));let n=l.getLinkedRecords("edges");i()(n,"Messages is ".concat(n));let t=n[n.length-1].getLinkedRecord("node");if(i()(t,"Last Message is ".concat(t)),t.getValue("isOptimistic")){s();return}if("human"!==t.getValue("author"))return;let r=C(),u=String(r),d=e.create(u,"Message"),c=t.getValue("creationTime");i()(c,"Last Creation Time is ".concat(c));let k=c+1e6;d.setValue(u,"id"),d.setValue(r,"messageId"),d.setValue("...","text"),d.setValue(k,"creationTime"),d.setValue(m.nickname,"author"),d.setValue(h.Z.incomplete,"state"),d.setValue([],"suggestedReplies"),d.setValue(!0,"isOptimistic"),d.setLinkedRecords([],"attachments"),d.setLinkedRecord(a,"chat");let p=o.ConnectionHandler.createEdge(e,l,d,"MessageEdge");o.ConnectionHandler.insertEdgeAfter(l,p)})},100);s()},onError:e=>{console.error(e),(0,o.commitLocalUpdate)(F,e=>{let l=e.get(g.id);i()(l,"Chat Record is ".concat(l));let n=o.ConnectionHandler.getConnection(l,S);i()(n,"Chat Connection is ".concat(n));let s=n.getLinkedRecords("edges");i()(s,"Messages is ".concat(s));let r=s[s.length-1].getLinkedRecord("node");i()(r,"Last Message is ".concat(r));let u=String(C()),d=e.create(u,"Message"),c=r.getValue("creationTime");i()(c,"Last Creation Time is ".concat(c));let m=c+1e6;d.setValue(u,"id"),d.setValue(C(),"messageId"),d.setValue(a,"text"),d.setValue(m,"creationTime"),d.setValue(t.human,"author"),d.setValue(h.Z.error,"state"),d.setValue([],"suggestedReplies"),d.setLinkedRecords([],"attachments"),window.navigator.onLine||d.setValue(!0,"offlineError"),d.setLinkedRecord(l,"chat");let k=o.ConnectionHandler.createEdge(e,n,d,"MessageEdge");o.ConnectionHandler.insertEdgeAfter(n,k)})},uploadables:w}),(0,c.CE)(V,g.chatId)},[k,g,m,F,n,v,s,M,L]);return w},H=(e,a)=>{let n=(0,o.useRelayEnvironment)(),t=(0,d.ZP)(),{resetLoggedOutTimeout:s}=(0,u.v)(),{nickname:i}=(0,o.useFragment)(l(14927),e),[c]=(0,o.useMutation)(l(98965)),g=(0,r.useCallback)(async e=>{let l,{prompt:r,files:u,source:g,optimisticChatId:m}=e;(0,o.commitLocalUpdate)(n,e=>{l=(0,F.z9)(e,m,r,u)});let p=await (0,K.h0)(),y=u?Array.from(u).reduce((e,a,l)=>({...e,["file".concat(l)]:a}),{}):void 0;c({variables:{bot:i,query:r,source:g,sdid:p,attachments:y?Array.from(Object.keys(y)):void 0},uploadables:y,updater:(e,a)=>{var n,t;let s=a.messageEdgeCreate.status;s!==f.Z.success&&(null===(n=e.get(l))||void 0===n||n.setValue(h.Z.error,"state"));let r=a.messageEdgeCreate.chat;if(r){(0,k.mK)(r.chatId,m),null===(t=e.get(l))||void 0===t||t.setValue(!1,"isOptimistic"),A(e,m,i);let a=e.get(r.id);a&&e.getRoot().setLinkedRecord(a,"chatOfCode",{chatCode:r.chatCode}),(0,_.rY)(e,r.defaultBotObject.id),Z(e,r.id),A(e,r.id,i)}},onCompleted:e=>{let{messageEdgeCreate:l}=e,n=l.status;if(n!==f.Z.success){t({type:d.pC.error,content:l.statusMessage});return}let i=U(l.failedUrls);i&&t({type:d.pC.error,content:i}),s(),null==a||a(e)},onError:e=>{console.error(e),l&&(0,o.commitLocalUpdate)(n,e=>{var a;null===(a=e.get(l))||void 0===a||a.setValue(h.Z.error,"state")})}})},[c,i,a,n,t,s]);return g},A=(e,a,l)=>{let n=e.get(a);i()(n,"Chat Record is ".concat(n));let t=o.ConnectionHandler.getConnection(n,S);i()(t,"Chat Connection is ".concat(t));let s=t.getLinkedRecords("edges");i()(s,"Messages is ".concat(s));let r=s[s.length-1].getLinkedRecord("node");if(i()(r,"Last Message is ".concat(r)),"human"!==r.getValue("author"))return;let u=String(C()),d=e.create(u,"Message"),c=r.getValue("creationTime");i()(c,"Last Creation Time is ".concat(c));let g=c+1e6;d.setValue(u,"id"),d.setValue(C(),"messageId"),d.setValue("...","text"),d.setValue(g,"creationTime"),d.setValue(l,"author"),d.setValue(h.Z.incomplete,"state"),d.setValue([],"suggestedReplies"),d.setValue(!0,"isOptimistic"),d.setLinkedRecords([],"attachments"),d.setLinkedRecord(n,"chat");let m=o.ConnectionHandler.createEdge(e,t,d,"MessageEdge");o.ConnectionHandler.insertEdgeAfter(t,m)},D=(e,a)=>{var n;let s=(0,o.useFragment)(l(90281),e),i=(0,o.useFragment)(l(74564),a),[u]=(0,o.useMutation)(l(53979)),d=o.ConnectionHandler.getConnectionID(null!==(n=null==s?void 0:s.id)&&void 0!==n?n:"",S),c=(0,r.useCallback)(()=>{s&&i&&u({variables:{connections:[d],chatId:s.chatId},optimisticResponse:{messageBreakEdgeCreate:{message:{id:I,cursor:T,node:{id:T,messageId:T,text:"",author:t.chatBreak,suggestedReplies:[],creationTime:1e3*Date.now(),state:h.Z.complete}},introductionMessage:i.introduction?{id:R,cursor:B,node:{id:B,messageId:B,text:i.introduction,author:i.model,suggestedReplies:[],creationTime:1e3*Date.now(),state:h.Z.complete}}:null}}})},[u,s,i,d]);return c},x=e=>{var a;let{edges:n}=e,t=(0,o.useFragment)(l(87410),n),s=null===(a=t[t.length-1])||void 0===a?void 0:a.node,i=null==s?void 0:s.text,u=null==i?void 0:i.length,d=(0,r.useCallback)(e=>{if(!s)return;let a=e.get(s.id);a&&(a.setValue(u,"textLengthOnCancellationImmediate"),a.setValue(i,"text"))},[s,i,u]);return{updater:d,message:s}},O=e=>{let{edges:a}=e,n=(0,o.useFragment)(l(90138),a),[t]=(0,o.useMutation)(l(30561)),{updater:s,message:i}=x({edges:n}),u=(0,r.useCallback)(()=>{if(!i)return;let e=i.text.length;t({variables:{messageId:i.messageId,textLength:e},optimisticResponse:{messageCancel:{message:{id:i.id,state:h.Z.cancelled,text:i.text,textLengthOnCancellation:e}}},updater:s})},[t,s,i]);return u},G=e=>{let{edges:a,chat:n,bot:s}=e,i=(0,o.useFragment)(l(38730),n),u=(0,o.useFragment)(l(37584),s),d=(0,o.useFragment)(l(65964),a),[c]=(0,o.useMutation)(l(93107)),{updater:g,message:m}=x({edges:d}),k=(0,r.useCallback)(()=>{var e;if(!m)return;let a=m.text.length,l=o.ConnectionHandler.getConnectionID(null!==(e=null==i?void 0:i.id)&&void 0!==e?e:"",S);c({variables:{connections:[l],messageId:m.messageId,textLength:a},optimisticResponse:{messageCancelAndBreakEdgeCreate:{message:{id:m.id,state:h.Z.cancelled,text:m.text,textLengthOnCancellation:a},messageBreakEdge:{id:I,cursor:T,node:{id:T,messageId:T,text:"",author:t.chatBreak,suggestedReplies:[],creationTime:1e3*Date.now(),state:h.Z.complete}},introductionMessageEdge:u.introduction?{id:R,cursor:B,node:{id:B,messageId:B,text:u.introduction,author:u.model,suggestedReplies:[],creationTime:1e3*Date.now(),state:h.Z.complete}}:null}},updater:g})},[i,u,c,m,g]);return k},U=e=>{if(0===e.length)return null;let a=e[0].reason;if(1===e.length)switch(a){case"fetch_error":return"Failed to fetch ".concat(e[0].url," because of a problem crawling the URL.");case"over_budget":return"Failed to fetch ".concat(e[0].url," because it was too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e[0].url," because it was not a supported content type.");default:return"Failed to fetch ".concat(e[0].url,".")}switch(a){case"fetch_error":return"Failed to fetch ".concat(e.length," urls because of problems crawling them.");case"over_budget":return"Failed to fetch ".concat(e.length," urls because they were too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e.length," urls because of unsupported content types.");default:return"Failed to fetch ".concat(e.length," urls.")}},Z=(e,a)=>{let l=e.getRoot(),n=o.ConnectionHandler.getConnection(l,"ChatHistoryList_queryRoot_chats");if(!n)return;let t=n.getLinkedRecords("edges");if(!t)return;let s=t.find(e=>{var l;return(null===(l=e.getLinkedRecord("node"))||void 0===l?void 0:l.getValue("id"))===a});if(s)o.ConnectionHandler.deleteNode(n,a),o.ConnectionHandler.insertEdgeBefore(n,s);else{let l=e.get(a);if(!l)return;let t=o.ConnectionHandler.createEdge(e,n,l,"ChatEdge");o.ConnectionHandler.insertEdgeBefore(n,t)}}},10406:function(e,a,l){l.d(a,{q:function(){return s}});var n=l(67294);let t=!1,s=()=>t;a.Z=()=>{let[e,a]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=()=>{t=!0,a(!0)},l=()=>{a(!1)};return window.addEventListener("offline",e),window.addEventListener("online",l),()=>{window.removeEventListener("offline",e),window.removeEventListener("online",l)}},[a]),e}},55554:function(e,a,l){l.d(a,{F5:function(){return L},t3:function(){return S},z9:function(){return v}});var n=l(41143),t=l.n(n),s=l(67294),i=l(22578),r=l(44311);let o=()=>Math.floor(1e9*Math.random()),u=e=>"OPTIMISTIC_CHAT_".concat(e),d=e=>r.ConnectionHandler.getConnectionID(e,"ChatMessagesView_chat_messagesConnection"),c=e=>"".concat(e,"_MESSAGE_PAGE_INFO"),g=e=>"".concat(e,"_MEMBER_PAGE_INFO"),m=e=>"".concat(e,"_INTRO_MESSAGE"),k=e=>"".concat(e,"_INTRO_MESSAGE_EDGE"),p=e=>"".concat(e,"_USER_MESSAGE"),y=e=>"".concat(e,"_USER_MESSAGE_EDGE"),f=e=>"".concat(e,"_MEMBERS_CONNECTION"),h=e=>"".concat(e,"_BOT_MEMBER_EDGE"),_=(e,a)=>"".concat(e,"_FILE_").concat(a),F=(e,a)=>"".concat(e,"_MESSAGE_ATTACHMENT_").concat(a),b=(e,a,l,n)=>{let t=a.getDataID(),s=_(t,n),i=e.create(s,"File");i.setValue(s,"id"),i.setValue("text","fileFormat"),i.setValue("OPTIMISTIC_FILE_HASH","fileHash"),i.setValue(l.type,"mimeType"),i.setValue(null,"processedUrl"),i.setValue(l.size,"size"),i.setValue("","url");let r=F(t,n),o=e.create(r,"MessageAttachment");return o.setValue(r,"id"),o.setValue(r,"attachmentId"),o.setValue(l.name,"name"),o.setLinkedRecord(i,"file"),o.setLinkedRecord(a,"message"),o},K=function(e,a,l,n,t,s){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],r=e.create(l,"Message");return r.setValue(l,"id"),r.setValue(l,"messageId"),r.setValue(n,"text"),r.setValue(s,"state"),r.setValue(t,"author"),r.setValue(t,"authorNickname"),r.setValue("chat_input","sourceType"),r.setValue("not_truncated","attachmentTruncationState"),r.setValue(1e3*Date.now(),"creationTime"),r.setValue("","clientNonce"),r.setValue(null,"textLengthOnCancellation"),r.setValue(null,"uid"),r.setValue(null,"vote"),r.setValue(null,"voteReason"),r.setValue([],"suggestedReplies"),r.setLinkedRecord(a,"chat"),r.setLinkedRecords(i.map((a,l)=>b(e,r,a,l)),"attachments"),r.setValue(!0,"isOptimistic"),r.setValue(0,"timeoutLevel"),r.setValue(null,"offlineError"),r.setValue(null,"textLengthOnCancellationImmediate"),r},S=(e,a)=>{let n=(0,i.useFragment)(l(16122),e),t=L(n),[r]=(0,s.useState)(()=>a||t());return r},L=e=>{let{introduction:a,id:n,nickname:t,model:r}=(0,i.useFragment)(l(15421),e),o=(0,i.useRelayEnvironment)();return(0,s.useCallback)(()=>C({environment:o,botId:n,botNickname:t,botModel:r,introduction:a}),[o,n,t,r,a])},C=e=>{let a,l,{environment:n,botId:s,botNickname:i,botModel:p,introduction:y}=e;return(0,r.commitLocalUpdate)(n,e=>{let n=e.get(s);for(t()(n,"bot is ".concat(n));!a||e.get(a);)a=u(l=o());let r=e.create(a,"Chat");r.setValue(a,"id"),r.setValue(a,"chatId"),r.setValue("","chatCode"),r.setValue(!0,"isOptimistic"),r.setValue(i,"defaultBotNickname"),r.setValue(1e3*Date.now(),"creationTime"),r.setValue(1e3*Date.now(),"lastInteractionTime"),r.setValue(null,"title"),r.setValue(!0,"shouldShowDisclaimer"),r.setValue(1e3*Date.now(),"creationTime"),r.setLinkedRecord(n,"defaultBotObject");let _=m(a),F=y?[K(e,r,_,y,p,"complete")]:[],b=F.map(l=>{t()(a,"chatId is ".concat(a));let n=e.create(k(a),"MessageEdge");return n.setLinkedRecord(l,"node"),n}),S=e.create(c(a),"PageInfo");S.setValue(!1,"hasPreviousPage"),S.setValue(y?_:null,"startCursor");let L=e.create(d(a),"MessagesConnection");L.setLinkedRecords(b,"edges"),L.setLinkedRecord(S,"pageInfo"),r.setLinkedRecord(L,"messagesConnection",{last:5}),r.setLinkedRecord(L,"__ChatMessagesView_chat_messagesConnection_connection");let C=[e.create(h(a),"ChatMemberEdge")];C[0].setLinkedRecord(n,"node");let v=e.create(g(a),"PageInfo");v.setValue(!1,"hasNextPage"),v.setValue(C[0].getDataID(),"endCursor");let M=e.create(f(a),"ChatMemberConnection");M.setLinkedRecords(C,"edges"),M.setLinkedRecord(v,"pageInfo"),r.setLinkedRecord(M,"membersConnection"),e.getRoot().setLinkedRecord(r,"optimisticChat",{optimisticChatId:a})}),t()(a,"chatId is ".concat(a)),t()(l,"chatIdNumber is ".concat(l)),a},v=function(e,a,l){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=e.get(d(a));t()(s,"messagesConnection is ".concat(s));let i=e.get(a);t()(i,"chat is ".concat(i));let o=p(a),u=K(e,i,o,l,"human","incomplete",n),c=e.create(y(a),"MessageEdge");return c.setLinkedRecord(u,"node"),r.ConnectionHandler.insertEdgeAfter(s,c),o}},80393:function(e,a,l){l.d(a,{_:function(){return t},z:function(){return n}});let n=e=>{let a="",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;for(;n<e;)a+=l.charAt(Math.floor(Math.random()*l.length)),n+=1;return a},t=()=>n(32)},32914:function(e,a){var l,n;(n=l||(l={})).not_deleted="not_deleted",n.user_deleted="user_deleted",n.poe_deleted="poe_deleted",n.llm_deleted="llm_deleted",n.hard_deleted="hard_deleted",a.Z=l},89083:function(e,a){var l,n;(n=l||(l={})).text_markdown="text_markdown",n.text_plain="text_plain",a.Z=l},47875:function(e,a){var l,n;(n=l||(l={})).success="success",n.no_access="no_access",n.too_many_tokens="too_many_tokens",n.reached_limit="reached_limit",n.bot_is_down="bot_is_down",n.exception="exception",n.rate_limit_exceeded="rate_limit_exceeded",n.unsupported_file_type="unsupported_file_type",n.file_too_large="file_too_large",a.Z=l}}]);